<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.139.4"><meta name=description content="We have shown in earlier posts how Velociraptor uses VQL to define event queries that can detect specific conditions. These conditions can be used to create alerts and escalation actions."><link rel=icon href=/images/favicon.png type=image/png><title>Alerting on event patterns :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1772163119 rel=stylesheet><link href=/css/font-awesome-all.min.css?1772163119 rel=stylesheet><link href=/css/featherlight.min.css?1772163119 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1772163119 rel=stylesheet><link href=/css/auto-complete.css?1772163119 rel=stylesheet><link href=/css/theme.css?1772163119 rel=stylesheet><link href=/css/tabs.css?1772163119 rel=stylesheet><link href=/css/hugo-theme.css?1772163119 rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css integrity=sha384-WcoG4HRXMzYzfCgiyfrySxx90XSl2rxY5mnVY5TwtWE6KLrArNKn0T/mOgNL0Mmi crossorigin=anonymous><link href=/css/theme-mine.css?1772163119 rel=stylesheet><link href=/css/dark.css?1772163119 rel=stylesheet><link href=/css/syntax.css?1772163119 rel=stylesheet><link href=/css/light.css?1772163119 rel=stylesheet><link href=/css/hljs.css?1772163119 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1772163119 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1772163119></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS")}</script><script></script></head><body data-url=/blog/html/2019/02/14/alerting_on_event_patterns/><nav id=sidebar><div id=header-wrapper><div id=header><a href=https://docs.velociraptor.app/><img class="logo dark" src=https://docs.velociraptor.app//images/VeloR7_DarkMode.svg>
<img class="logo light" src=https://docs.velociraptor.app//images/VeloR7_LightMode.svg></a><div class="ThemeSelector darkmode"><i class="fas fa-moon"></i></div><div class="ThemeSelector lightmode"><i class="fas fa-sun"></i></div><script>const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?$("body").addClass("dark").removeClass("light"):$("body").addClass("light").removeClass("dark"),$(".ThemeSelector.darkmode").on("click",function(){return $("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/",!1}),$(".ThemeSelector.lightmode").on("click",function(){return $("body").addClass("light").removeClass("dark"),document.cookie="theme=lightmode;path=/",!1})</script></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/><i class="fas fa-exclamation-triangle"></i>Security Advisories</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2025-14728/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2025-14728/>CVE-2025-14728</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2025-6264/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2025-6264/>CVE-2025-6264</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2025-0914/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2025-0914/>CVE-2025-0914</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2024-10526/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2024-10526/>CVE-2024-10526</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-5950/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2023-5950/>CVE-2023-5950</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-2226/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2023-2226/>CVE-2023-2226</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0242/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2023-0242/>CVE-2023-0242</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0290/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2023-0290/>CVE-2023-0290</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/overview/support/>Support Policy</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/security/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/overview/security/>Security</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/quickstart/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/quickstart/>Quickstart</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/>Server Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/key_concepts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/key_concepts/>Key Concepts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/key_decisions/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/key_decisions/>Key Decisions</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/deployment_example/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/deployment_example/>Deployment Example</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/multifrontend/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/multifrontend/>Multi-Frontend</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/upgrades/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/upgrades/>Upgrades</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/orgs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/orgs/>Organizations</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/>Offline Collections</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/building/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/building/>Building</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/running/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/running/>Running</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/collection_data/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/collection_data/>Collection Data</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/updating/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/updating/>Updating</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/troubleshooting/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/troubleshooting/>Troubleshooting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/security/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/references/><i class="fas fa-book"></i>Config Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/>The Admin GUI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/artifacts/>Managing Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/keyboard_shortcuts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/keyboard_shortcuts/>Keyboard Shortcuts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/user_preferences/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/user_preferences/>User Preferences</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/customizing/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/customizing/>Customization</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/>Managing Clients</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/clients/searching/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/searching/>Searching for clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/interrogation/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/interrogation/>Interrogation</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/artifacts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/artifacts/>Collecting Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/labels/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/labels/>Labels</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/metadata/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/metadata/>Metadata</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/quarantine/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/quarantine/>Quarantine</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/vfs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/vfs/>Virtual File System</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/shell/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/shell/>Shell Commands</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/monitoring/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/monitoring/>Monitoring</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/>VQL</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/fundamentals/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/fundamentals/>VQL Fundamentals</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/events/>Event Queries</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/join/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/join/>JOIN in VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/artifacts/>Artifacts</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/calling/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/artifacts/calling/>Calling Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/managing/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/artifacts/managing/>Managing Artifacts</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/extending_vql/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/vql_reference/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/>Artifacts</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/managing/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/managing/>Managing Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/basic_fields/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/basic_fields/>Basic Fields</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/advanced_fields/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/advanced_fields/>Advanced Fields</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/parameters/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/parameters/>Parameters</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/sources/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/sources/>Sources</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/preconditions/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/preconditions/>Preconditions</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/export_imports/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/export_imports/>Export & Imports</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/calling_artifacts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/calling_artifacts/>Calling Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/event_queues/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/event_queues/>Event Queues</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/tools/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/tools/>Tools</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/resources/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/resources/>Resource Limits</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/security/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/use_cases/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/use_cases/>Other Use Cases</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/tips/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/tips/>Artifact Writing Tips</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/artifact_reference/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/artifact_reference/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/exchange_reference/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/exchange_reference/><i class="fas fa-code"></i>Artifact Exchange</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/notebooks/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/hunting/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/hunting/>Hunting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/filesystem/>Searching Filesystems</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/paths/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/filesystem/paths/>Velociraptor Paths</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/remapping/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/filesystem/remapping/>Remapping Accessors</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ntfs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/filesystem/ntfs/>NTFS Analysis</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/deaddisk/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/deaddisk/>Dead Disk Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/deaddisk/creating_running/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/deaddisk/creating_running/>Creating & Running</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/file_collection/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/file_collection/>File Acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/file_collection/bulk/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/file_collection/bulk/>Bulk File Acquisition</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/file_collection/vfs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/file_collection/vfs/>VFS Uploads</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/file_collection/exporting/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/file_collection/exporting/>Bulk File Exports</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/>CLI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/cli/acl/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/acl/>acl</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/artifacts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/artifacts/>artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/collector/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/collector/>collector</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/config/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/config/>config</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/deaddisk/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/deaddisk/>deaddisk</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/fs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/fs/>fs (filesystem)</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/fuse/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/fuse/>fuse</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/query/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/query/>query</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/server_service/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/server_service/>server_service</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/service/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/service/>service</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/tools/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/tools/>tools</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/user/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/user/>user</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/misc/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/misc/>Miscellaneous</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/flags/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/flags/>CLI flags</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/>Troubleshooting</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/deployment/server/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/deployment/server/>Server</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/deployment/client/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/deployment/client/>Client</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/deployment/offline_collector/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/deployment/offline_collector/>Offline Collector</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/operations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/operations/>Operations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/operations/server_ops/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/operations/server_ops/>Server Ops</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/operations/remote_clients/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/operations/remote_clients/>Remote Clients</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/vql/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/vql/>VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/>Debugging</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/internal/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/internal/>Internal</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/internal/metrics/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/internal/metrics/>Metrics</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/internal/go_profiles/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/internal/go_profiles/>Golang</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/client/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/client/>Client</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/client/client_monitoring/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/client/client_monitoring/>Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/client/client_flows/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/client/client_flows/>Flows</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/>Global</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/datastore/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/datastore/>Datastore</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/datastore/replication/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/datastore/replication/>Replication</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/>Services</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/export/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/export/>ExportContainers</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/throttler/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/throttler/>Throttler</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/user_manager/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/user_manager/>User Manager</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/open_close/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/open_close/>Open-close</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/tempfiles/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/tempfiles/>tempfiles</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/worker/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/worker/>worker</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/>VQL</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/queries/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/queries/>Queries</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/queries/active_queries/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/queries/active_queries/>Active Queries</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/queries/plugin_monitor/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/queries/plugin_monitor/>Plugin Monitor</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/queries/recent_queries/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/queries/recent_queries/>Recent Queries</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/>Plugins</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/etw/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/etw/>ETW</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/glob/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/glob/>Glob</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/ntfs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/ntfs/>NTFS Cache</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/sigma/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/sigma/>Sigma Tracker</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/windows_event/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/windows_event/>Windows Event Log Watcher</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/zip/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/zip/>Zip</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/process/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/process/>Process Tracker</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/sqlite/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/sqlite/>Sqlite</a></div></li></ul></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/>Org</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/>Services</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/broadcast_service/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/broadcast_service/>Broadcast</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/queue_manager/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/queue_manager/>QueueManager</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/vfs_service/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/vfs_service/>VFS</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/notifier/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/notifier/>Notifier</a></div></li></ul></li></ul></li></ul></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/downloads/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/downloads/><i class="fas fa-download"></i>Downloads</a></div></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/popular/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/popular/>Frequently Used âœ¨</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/windows/>Windows-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/linux/>Linux-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/server/>Server-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/encode/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/encode/>Encode/Decode</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/developer/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/developer/>Developer</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/other/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/other/>Other</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/accessors/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/accessors/>Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div><ul><li data-nav-id=https://docs.velociraptor.app/training/playbooks/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/training/playbooks/><i class="fas fa-play"></i>Playbooks</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item parent haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_velocon/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2023_velocon/>VeloCON 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2024_auscert/>Auscert 2024</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2024_auscert-detection-engineering/>Auscert 2024 Talk</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2025_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2025_auscert-detection-engineering/>Auscert 2025 Workshop</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a rel=nofollow class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>GitHub</a></li><li><a rel=nofollow class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a rel=nofollow class=padding href=https://docs.velociraptor.app/youtube/><i class='fab fa-youtube'></i>YouTube</a></li><li><a rel=nofollow class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a rel=nofollow class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li><li><a rel=nofollow class=padding href=https://docs.rapid7.com/insightidr/velociraptor-integration/><i class='fa fa-question-circle'></i>Rapid7 Docs</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2025</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/blog/html/2019/02/14/alerting_on_event_patterns/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><span itemprop=item><span itemprop=name>Alerting on event patterns</span></span>
<meta itemprop=position content="1"></span></div><div class=progress><div class=wrapper><nav id=TableOfContents></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Alerting on event patterns</h1><p>We have shown in earlier posts how Velociraptor uses VQL to define event
queries that can detect specific conditions. These conditions can be
used to create alerts and escalation actions.</p><p>One of the most useful types of alerts is detecting a pattern of
activity. For example we can detect failed and successful login attempts
separately, but it is the specific pattern of events (say 5 failed login
attempts followed by a successful one) that is interesting from a
detection point of view.</p><p>This post illustrates how this kind of temporal correlation can be
expressed in a VQL query. We then use it to create alerts for attack
patterns commonly seen by intrusions.</p><h1 id=event-queries>Event Queries</h1><p>Velociraptor executes queries written in the Velociraptor Query Language
(VQL). The queries can be executed on the client, and their results
streamed to the server. Alternatively the queries may be executed on the
server and process the result of other queries which collected
information from the client.</p><p>A VQL query does not have to terminate at all. VQL queries draw their
data from a VQL plugin which may simply return data rows at different
times. For example, consider the following query:</p><pre><code class=language-{.sourceCode>SELECT EventData as FailedEventData,
       System as FailedSystem
FROM watch_evtx(filename=securityLogFile)
WHERE System.EventID = 4625
</code></pre><p>This query sets up a watcher on a windows event log file. As new events
are written to the log file, the query will produce those events as new
rows. The rows will then be filtered so we only see event id 4625
(Failed logon event).</p><p>Velociraptor can implement event queries on the client or on the server.
For example, say we wanted to collect all failed event logs with the
query above. We would write an artifact that encapsulates this query:</p><pre><code class=language-{.sourceCode>name: Windows.System.FailedLoginAttempts
parameters:
  - name: securityLogFile
    default: C:/Windows/System32/Winevt/Logs/Security.evtx
sources:
  - queries:
     - SELECT EventData as FailedEventData,
           System as FailedSystem
       FROM watch_evtx(filename=securityLogFile)
       WHERE System.EventID.Value = 4625
</code></pre><p>Then we simply add that artifact to the monitored artifact list in the
config file:</p><pre><code class=language-{.sourceCode>Events:
  artifacts:
  - Generic.Client.Stats
  - Windows.System.FailedLoginAttempts
  version: 2
  ops_per_second: 10
</code></pre><p>The monitored artifacts are run on all clients connected to the server.
The output from these queries is streamed to the server and stored in
the client's monitoring VFS directory.</p><p>Lets test this artifact by trying to run a command using the runas
windows command. We will be prompted for a password but failing to give
the correct password will result in a login failure event:</p><p><img class=inline src=1.png></p><p>After a few seconds the event will be written to the windows event log
and the watch_evtx() VQL plugin will emit the row - which will be
streamed to the VFS monitoring directory on the server, where it can be
viewed in the GUI:</p><p><figure id=fb5c81ed3a220004b71069645f112867><div data-featherlight=#fb5c81ed3a220004b71069645f112867 class=figure><img src=2.png alt=image></div><figcaption><a class=image-link href=2.png><i class="fa fa-download"></i></a>
image</figcaption></figure></p><p>The above screenshot shows that the monitoring directory now contains a
subdirectory named after the artifact we created. Inside this directory
are CSV files for each day and every failed logon attempt is detailed
there.</p><h1 id=time-correlation>Time correlation</h1><p>While it is interesting to see all failed logon attempts in many cases
these events are just noise. If you put any server on the internet (e.g.
an RDP or SSH server) you will experience thousands of brute force
attempts to break in. This is just the nature of the internet. If your
password policy is strong enough it should not be a big problem.</p><p>However, what if someone guesses the password for one of your accounts?
Then the activity pattern is more like a bunch of failed logons followed
by a successful logon for the same account.</p><p>This pattern is way more interesting than just watching for a series of
failed logons (although that is also good to know).</p><p>But how do we write a query to detect this? Essentially the query needs
to look back in time to see how many failed logon attempts preceded
each successful logon.</p><p>This is a typical problem which may be generalized as followed:</p><p>::: {.admonition}
Goal</p><p>We want to detect an event A proceeded by a specified number of events B
within a defined time window.
:::</p><p>This problem may be generalized for example:</p><ol><li>Detect a user account created and deleted within a short time
window.</li><li>A beacon to a specific DNS followed by at least 5 beacons within the
last 5 hours to same DNS (Event A and B are the same).</li></ol><h1 id=the-fifo-plugin>The fifo() plugin</h1><p>How shall we write the VQL query to achieve this? This is made possible
by use of the fifo() plugin. As its name suggests, the FIFO plugin acts
as a First In First Out cache for event queries.</p><p><figure id=8cee15d3c5ef79897c7fc6014e9a27c8><div data-featherlight=#8cee15d3c5ef79897c7fc6014e9a27c8 class=figure><svg viewBox="0 0 914.994750656168 393.43832020997377" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10" xmlns:xlink="http://www.w3.org/1999/xlink"><clipPath id="p.0"><path d="m0 0h914.99475v393.43832H0V0z" clip-rule="nonzero"/></clipPath><g clip-path="url(#p.0)"><path fill="#000" fill-opacity="0" d="m0 0h914.99475v393.43832H0z" fill-rule="evenodd"/><path fill="#f3f3f3" d="m203.69292 148.23097h124.62993v117.70079H203.69292z" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m203.69292 148.23097h124.62993v117.70079H203.69292z" fill-rule="evenodd"/><path fill="#000" d="m214.16167 214.00136v-13.359375h5.921875q1.78125.0 2.703125.359375.9375.359375 1.484375 1.28125.5625.90625.5625 2.015625.0 1.40625-.921875 2.390625-.921875.96875-2.84375 1.234375.703125.34375 1.078125.671875.765625.703125 1.453125 1.765625l2.328125 3.640625h-2.21875l-1.765625-2.78125q-.78125-1.203125-1.28125-1.828125-.5-.640625-.90625-.890625-.390625-.265625-.796875-.359375-.296875-.078125-.984375-.078125h-2.046875v5.9375h-1.765625zm1.765625-7.453125h3.796875q1.21875.0 1.890625-.25.6875-.265625 1.046875-.8125t.359375-1.1875q0-.953125-.6875-1.5625t-2.1875-.609375h-4.21875v4.421875zm10.863571 2.609375q0-2.6875 1.484375-3.96875 1.25-1.078125 3.046875-1.078125 2 0 3.265625 1.3125 1.265625 1.296875 1.265625 3.609375.0 1.859375-.5625 2.9375-.5625 1.0625-1.640625 1.65625-1.0625.59375-2.328125.59375-2.03125.0-3.28125-1.296875-1.25-1.3125-1.25-3.765625zm1.6875.0q0 1.859375.796875 2.796875.8125.921875 2.046875.921875 1.21875.0 2.03125-.921875.8125-.9375.8125-2.84375.0-1.796875-.8125-2.71875t-2.03125-.921875q-1.234375.0-2.046875.921875-.796875.90625-.796875 2.765625zm11.078842 4.84375-2.96875-9.671875h1.703125l1.53125 5.578125.578125 2.078125q.046875-.15625.5-2l1.546875-5.65625h1.6875l1.4375 5.609375.484375 1.84375.5625-1.859375 1.65625-5.59375h1.59375l-3.03125 9.671875h-1.703125l-1.53125-5.796875-.375-1.640625-1.953125 7.4375h-1.71875zm22.593735.0h-1.640625v-10.453125q-.59375.5625-1.5625 1.140625-.953125.5625-1.71875.84375v-1.59375q1.375-.640625 2.40625-1.5625t1.453125-1.78125h1.0625v13.40625z" fill-rule="nonzero"/><path fill="#f3f3f3" d="m360.32285 148.23097h124.62991v117.70079H360.32285z" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m360.32285 148.23097h124.62991v117.70079H360.32285z" fill-rule="evenodd"/><path fill="#000" d="m370.7916 214.00136v-13.359375h5.921875q1.78125.0 2.703125.359375.9375.359375 1.484375 1.28125.5625.90625.5625 2.015625.0 1.40625-.921875 2.390625-.921875.96875-2.84375 1.234375.703125.34375 1.078125.671875.765625.703125 1.453125 1.765625l2.328125 3.640625h-2.21875l-1.765625-2.78125q-.78125-1.203125-1.28125-1.828125-.5-.640625-.90625-.890625-.390625-.265625-.796875-.359375-.296875-.078125-.984375-.078125h-2.046875v5.9375H370.7916zm1.765625-7.453125h3.796875q1.21875.0 1.890625-.25.6875-.265625 1.046875-.8125t.359375-1.1875q0-.953125-.6875-1.5625t-2.1875-.609375h-4.21875v4.421875zm10.863556 2.609375q0-2.6875 1.484375-3.96875 1.25-1.078125 3.046875-1.078125 2 0 3.265625 1.3125 1.265625 1.296875 1.265625 3.609375.0 1.859375-.5625 2.9375-.5625 1.0625-1.640625 1.65625-1.0625.59375-2.328125.59375-2.03125.0-3.28125-1.296875-1.25-1.3125-1.25-3.765625zm1.6875.0q0 1.859375.796875 2.796875.8125.921875 2.046875.921875 1.21875.0 2.03125-.921875.8125-.9375.8125-2.84375.0-1.796875-.8125-2.71875t-2.03125-.921875q-1.234375.0-2.046875.921875-.796875.90625-.796875 2.765625zm11.078857 4.84375-2.96875-9.671875h1.703125l1.53125 5.578125.578125 2.078125q.046875-.15625.5-2l1.546875-5.65625h1.6875l1.4375 5.609375.484375 1.84375.5625-1.859375 1.65625-5.59375h1.59375l-3.03125 9.671875h-1.703125l-1.53125-5.796875-.375-1.640625-1.953125 7.4375h-1.71875zm25.03125-1.578125v1.578125h-8.828125q-.015625-.59375.1875-1.140625.34375-.90625 1.078125-1.78125.75-.875 2.15625-2.015625 2.171875-1.78125 2.9375-2.828125t.765625-1.96875q0-.984375-.703125-1.640625-.6875-.671875-1.8125-.671875-1.1875.0-1.90625.71875-.703125.703125-.703125 1.953125l-1.6875-.171875q.171875-1.890625 1.296875-2.875 1.140625-.984375 3.03125-.984375 1.921875.0 3.046875 1.0625t1.125 2.640625q0 .796875-.328125 1.578125t-1.09375 1.640625q-.75.84375-2.53125 2.34375-1.46875 1.234375-1.890625 1.6875-.421875.4375-.6875.875h6.546875z" fill-rule="nonzero"/><path fill="#f3f3f3" d="m524.95276 148.23097h124.629944v117.70079H524.95276z" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m524.95276 148.23097h124.629944v117.70079H524.95276z" fill-rule="evenodd"/><path fill="#000" d="m535.4215 214.00136v-13.359375h5.921875q1.78125.0 2.703125.359375.9375.359375 1.484375 1.28125.5625.90625.5625 2.015625.0 1.40625-.921875 2.390625-.921875.96875-2.84375 1.234375.703125.34375 1.078125.671875.765625.703125 1.453125 1.765625l2.328125 3.640625h-2.21875l-1.765625-2.78125q-.78125-1.203125-1.28125-1.828125-.5-.640625-.90625-.890625-.390625-.265625-.796875-.359375-.296875-.078125-.984375-.078125h-2.046875v5.9375H535.4215zm1.765625-7.453125H540.984q1.21875.0 1.890625-.25.6875-.265625 1.046875-.8125t.359375-1.1875q0-.953125-.6875-1.5625t-2.1875-.609375h-4.21875v4.421875zm10.863586 2.609375q0-2.6875 1.484375-3.96875 1.25-1.078125 3.046875-1.078125 2 0 3.265625 1.3125 1.265625 1.296875 1.265625 3.609375.0 1.859375-.5625 2.9375-.5625 1.0625-1.640625 1.65625-1.0625.59375-2.328125.59375-2.03125.0-3.28125-1.296875-1.25-1.3125-1.25-3.765625zm1.6875.0q0 1.859375.796875 2.796875.8125.921875 2.046875.921875 1.21875.0 2.03125-.921875.8125-.9375.8125-2.84375.0-1.796875-.8125-2.71875t-2.03125-.921875q-1.234375.0-2.046875.921875-.796875.90625-.796875 2.765625zm11.078796 4.84375-2.96875-9.671875h1.703125l1.53125 5.578125.578125 2.078125q.046875-.15625.5-2l1.546875-5.65625h1.6875l1.4375 5.609375.484375 1.84375.5625-1.859375 1.65625-5.59375h1.59375l-3.03125 9.671875h-1.703125l-1.53125-5.796875-.375-1.640625-1.953125 7.4375h-1.71875zm16.421875-3.53125 1.640625-.21875q.28125 1.40625.953125 2.015625.6875.609375 1.65625.609375 1.15625.0 1.953125-.796875t.796875-1.984375q0-1.125-.734375-1.859375t-1.875-.734375q-.46875.0-1.15625.171875l.1875-1.4375q.15625.015625.265625.015625 1.046875.0 1.875-.546875.84375-.546875.84375-1.671875.0-.90625-.609375-1.5t-1.578125-.59375q-.953125.0-1.59375.609375-.640625.59375-.8125 1.796875l-1.640625-.296875q.296875-1.640625 1.359375-2.546875t2.65625-.90625q1.09375.0 2 .46875.921875.46875 1.40625 1.28125.5.8125.5 1.71875.0.859375-.46875 1.578125-.46875.703125-1.375 1.125 1.1875.28125 1.84375 1.140625t.65625 2.15625q0 1.734375-1.28125 2.953125-1.265625 1.21875-3.21875 1.21875-1.765625.0-2.921875-1.046875t-1.328125-2.71875z" fill-rule="nonzero"/><path fill="#f3f3f3" d="m689.5827 148.23097h124.62988v117.70079H689.5827z" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m689.5827 148.23097h124.62988v117.70079H689.5827z" fill-rule="evenodd"/><path fill="#000" d="m700.05145 214.00136v-13.359375h5.921875q1.78125.0 2.703125.359375.9375.359375 1.484375 1.28125.5625.90625.5625 2.015625.0 1.40625-.921875 2.390625-.921875.96875-2.84375 1.234375.703125.34375 1.078125.671875.765625.703125 1.453125 1.765625l2.328125 3.640625h-2.21875l-1.765625-2.78125q-.78125-1.203125-1.28125-1.828125-.5-.640625-.90625-.890625-.390625-.265625-.796875-.359375-.296875-.078125-.984375-.078125h-2.046875v5.9375h-1.765625zm1.765625-7.453125h3.796875q1.21875.0 1.890625-.25.6875-.265625 1.046875-.8125t.359375-1.1875q0-.953125-.6875-1.5625t-2.1875-.609375h-4.21875v4.421875zm10.863525 2.609375q0-2.6875 1.484375-3.96875 1.25-1.078125 3.046875-1.078125 2 0 3.265625 1.3125 1.265625 1.296875 1.265625 3.609375.0 1.859375-.5625 2.9375-.5625 1.0625-1.640625 1.65625-1.0625.59375-2.328125.59375-2.03125.0-3.28125-1.296875-1.25-1.3125-1.25-3.765625zm1.6875.0q0 1.859375.796875 2.796875.8125.921875 2.046875.921875 1.21875.0 2.03125-.921875.8125-.9375.8125-2.84375.0-1.796875-.8125-2.71875t-2.03125-.921875q-1.234375.0-2.046875.921875-.796875.90625-.796875 2.765625zm11.078857 4.84375-2.96875-9.671875h1.703125l1.53125 5.578125.578125 2.078125q.046875-.15625.5-2l1.546875-5.65625h1.6875l1.4375 5.609375.484375 1.84375.5625-1.859375 1.65625-5.59375h1.59375l-3.03125 9.671875h-1.703125l-1.53125-5.796875-.375-1.640625-1.953125 7.4375h-1.71875zm21.671875.0v-3.203125h-5.796875v-1.5l6.09375-8.65625h1.34375v8.65625h1.796875v1.5h-1.796875v3.203125h-1.640625zm0-4.703125v-6.015625l-4.1875 6.015625h4.1875z" fill-rule="nonzero"/><path fill="#f3f3f3" d="m32.307087 120.54593h108.47244v154.99176l-18.079102 18.079102h-90.39334z" fill-rule="evenodd"/><path fill="#c2c2c2" d="m122.700424 293.6168 3.6158218-14.463287 14.46328-3.6158142z" fill-rule="evenodd"/><path fill="#000" fill-opacity="0" d="m122.700424 293.6168 3.6158218-14.463287 14.46328-3.6158142-18.079102 18.079102h-90.39334v-173.07086h108.47244v154.99176" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m122.700424 293.6168 3.6158218-14.463287 14.46328-3.6158142-18.079102 18.079102h-90.39334v-173.07086h108.47244v154.99176" fill-rule="evenodd"/><path fill="#000" d="m42.150837 200.66493 1.65625-.140625q.125 1 .546875 1.640625.4375.640625 1.34375 1.046875.921875.390625 2.0625.390625 1 0 1.78125-.296875t1.15625-.8125q.375-.53125.375-1.15625t-.375-1.09375q-.359375-.46875-1.1875-.796875-.546875-.203125-2.390625-.640625-1.828125-.453125-2.5625-.84375-.96875-.5-1.4375-1.234375-.46875-.75-.46875-1.671875.0-1 .578125-1.875.578125-.890625 1.671875-1.34375 1.109375-.453125 2.453125-.453125 1.484375.0 2.609375.484375 1.140625.46875 1.75 1.40625.609375.921875.65625 2.09375l-1.6875.125q-.140625-1.265625-.9375-1.90625-.78125-.65625-2.3125-.65625-1.609375.0-2.34375.59375t-.734375 1.421875q0 .71875.53125 1.171875.5.46875 2.65625.96875 2.15625.484375 2.953125.84375 1.171875.53125 1.71875 1.359375.5625.828125.5625 1.90625.0 1.0625-.609375 2.015625-.609375.9375-1.75 1.46875-1.140625.515625-2.578125.515625-1.8125.0-3.046875-.53125-1.21875-.53125-1.921875-1.59375-.6875-1.0625-.71875-2.40625zm19.162323 4.296875v-1.421875q-1.125 1.640625-3.0625 1.640625-.859375.0-1.609375-.328125-.734375-.328125-1.09375-.828125t-.5-1.21875q-.109375-.46875-.109375-1.53125v-5.984375h1.640625v5.359375q0 1.28125.109375 1.734375.15625.640625.65625 1.015625t1.234375.375 1.375-.375q.65625-.390625.921875-1.03125.265625-.65625.265625-1.890625v-5.1875h1.640625v9.671875h-1.46875zm5.5475883.0h-1.515625V191.60243h1.640625v4.765625q1.046875-1.296875 2.65625-1.296875.890625.0 1.6875.359375t1.3125 1.015625q.515625.640625.796875 1.5625.296875.921875.296875 1.96875.0 2.484375-1.234375 3.84375-1.21875 1.359375-2.953125 1.359375-1.703125.0-2.6875-1.4375v1.21875zm-.015625-4.90625q0 1.734375.484375 2.515625.765625 1.265625 2.09375 1.265625 1.078125.0 1.859375-.9375t.78125-2.78125q0-1.890625-.75-2.796875t-1.828125-.90625q-1.0625.0-1.859375.9375-.78125.9375-.78125 2.703125zm24.402771 3.46875q1.234375.859375 2.265625 1.25l-.515625 1.21875q-1.4375-.515625-2.875-1.625-1.484375.828125-3.28125.828125-1.8125.0-3.296875-.875-1.46875-.875-2.265625-2.453125-.796875-1.59375-.796875-3.578125t.796875-3.59375q.8125-1.625 2.28125-2.46875 1.484375-.859375 3.328125-.859375t3.328125.890625q1.484375.875 2.265625 2.453125t.78125 3.5625q0 1.65625-.5 2.96875t-1.515625 2.28125zm-3.890625-2.25q1.53125.421875 2.515625 1.28125 1.5625-1.421875 1.5625-4.28125.0-1.625-.546875-2.828125-.546875-1.21875-1.609375-1.875-1.0625-.671875-2.390625-.671875-1.96875.0-3.28125 1.359375-1.296875 1.34375-1.296875 4.03125.0 2.59375 1.28125 4 1.296875 1.390625 3.296875 1.390625.953125.0 1.78125-.359375-.828125-.53125-1.75-.765625l.4375-1.28125zm14.402054 3.6875v-1.421875q-1.125 1.640625-3.0625 1.640625-.859375.0-1.609375-.328125-.734375-.328125-1.09375-.828125t-.5-1.21875q-.109375-.46875-.109375-1.53125v-5.984375h1.640625v5.359375q0 1.28125.109375 1.734375.15625.640625.65625 1.015625t1.234375.375 1.375-.375q.65625-.390625.921875-1.03125.265625-.65625.265625-1.890625v-5.1875h1.640625v9.671875h-1.46875zm10.672592-3.109375 1.6875.203125q-.40625 1.484375-1.484375 2.3125-1.078125.8125-2.765625.8125-2.125.0-3.375-1.296875-1.234375-1.3125-1.234375-3.671875.0-2.453125 1.25-3.796875 1.265625-1.34375 3.265625-1.34375 1.9375.0 3.15625 1.328125 1.234375 1.3125 1.234375 3.703125.0.15625.0.4375h-7.21875q.09375 1.59375.90625 2.453125.8125.84375 2.015625.84375.90625.0 1.546875-.46875.640625-.484375 1.015625-1.515625zm-5.390625-2.65625h5.40625q-.109375-1.21875-.625-1.828125-.78125-.953125-2.03125-.953125-1.125.0-1.90625.765625-.765625.75-.84375 2.015625zm9.125717 5.765625v-9.671875h1.46875v1.46875q.5625-1.03125 1.03125-1.359375.484375-.328125 1.0625-.328125.828125.0 1.6875.53125l-.5625 1.515625q-.609375-.359375-1.203125-.359375-.546875.0-.96875.328125t-.609375.890625q-.28125.875-.28125 1.921875v5.0625h-1.625zm6.150177 3.71875-.1875-1.53125q.546875.140625.9375.140625.546875.0.875-.1875.328125-.171875.546875-.5.15625-.25.5-1.21875.046875-.140625.140625-.40625l-3.671875-9.6875h1.765625l2.015625 5.59375q.390625 1.078125.703125 2.25.28125-1.125.671875-2.203125l2.078125-5.640625h1.640625l-3.6875 9.828125q-.59375 1.609375-.921875 2.203125-.4375.8125-1 1.1875t-1.34375.375q-.484375.0-1.0625-.203125z" fill-rule="nonzero"/><path fill="#f3f3f3" d="m146.53806 199.03674h29.732285v-10.960632l21.921265 21.921265-21.921265 21.921265v-10.960632H146.53806z" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m146.53806 199.03674h29.732285v-10.960632l21.921265 21.921265-21.921265 21.921265v-10.960632H146.53806z" fill-rule="evenodd"/><path fill="#f3f3f3" d="m308.66928 199.03674h29.7323v-10.960632l21.921265 21.921265-21.921265 21.921265v-10.960632h-29.7323z" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m308.66928 199.03674h29.7323v-10.960632l21.921265 21.921265-21.921265 21.921265v-10.960632h-29.7323z" fill-rule="evenodd"/><path fill="#f3f3f3" d="m473.29922 199.03674h29.73227v-10.960632l21.921265 21.921265-21.921265 21.921265v-10.960632h-29.73227z" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m473.29922 199.03674h29.73227v-10.960632l21.921265 21.921265-21.921265 21.921265v-10.960632h-29.73227z" fill-rule="evenodd"/><path fill="#f3f3f3" d="m637.92914 199.03674h29.7323v-10.960632l21.921265 21.921265-21.921265 21.921265v-10.960632h-29.7323z" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m637.92914 199.03674h29.7323v-10.960632l21.921265 21.921265-21.921265 21.921265v-10.960632h-29.7323z" fill-rule="evenodd"/><path fill="#000" fill-opacity="0" d="m13.845144 116.229355c0-27.826431 22.55778-50.38421 50.38421-50.38421h762.3182c13.362732.0 26.178162 5.308319 35.627014 14.7571945 9.448853 9.448868 14.757202 22.26429 14.757202 35.627014v201.5308c0 27.826416-22.5578 50.384186-50.384216 50.384186h-762.3182c-27.826431.0-50.38421-22.55777-50.38421-50.384186z" fill-rule="evenodd"/><path stroke="#000" stroke-width="1" stroke-linejoin="round" stroke-linecap="butt" d="m13.845144 116.229355c0-27.826431 22.55778-50.38421 50.38421-50.38421h762.3182c13.362732.0 26.178162 5.308319 35.627014 14.7571945 9.448853 9.448868 14.757202 22.26429 14.757202 35.627014v201.5308c0 27.826416-22.5578 50.384186-50.384216 50.384186h-762.3182c-27.826431.0-50.38421-22.55777-50.38421-50.384186z" fill-rule="evenodd"/><path fill="#000" fill-opacity="0" d="m182.05511 8.154856h167.90552v49.6063H182.05511z" fill-rule="evenodd"/><path fill="#000" d="m191.89886 30.777979 1.65625-.140625q.125 1 .546875 1.6406231.4375.640625 1.34375 1.046875.921875.390625 2.0625.390625 1 0 1.78125-.296875t1.15625-.8125q.375-.53125.375-1.1562481.0-.625-.375-1.09375-.359375-.46875-1.1875-.796875-.546875-.203125-2.390625-.640625-1.828125-.453125-2.5625-.84375-.96875-.5-1.4375-1.234375-.46875-.75-.46875-1.671875.0-1 .578125-1.875.578125-.890625 1.671875-1.34375 1.109375-.453125 2.453125-.453125 1.484375.0 2.609375.484375 1.140625.46875 1.75 1.40625.609375.921875.65625 2.09375l-1.6875.125q-.140625-1.265625-.9375-1.90625-.78125-.65625-2.3125-.65625-1.609375.0-2.34375.59375t-.734375 1.421875q0 .71875.53125 1.171875.5.46875 2.65625.96875 2.15625.484375 2.953125.84375 1.171875.53125 1.71875 1.359375.5625.828125.5625 1.90625.0 1.0624981-.609375 2.015623-.609375.9375-1.75 1.46875-1.140625.515625-2.578125.515625-1.8125.0-3.046875-.53125-1.21875-.53125-1.921875-1.59375-.6875-1.0625-.71875-2.406248zm16.412323 2.828123.234375 1.453125q-.6875.140625-1.234375.140625-.890625.0-1.390625-.28125-.484375-.28125-.6875-.734375-.203125-.46875-.203125-1.9375v-5.578123h-1.203125v-1.265625h1.203125v-2.390625l1.625-.984375v3.375h1.65625v1.265625h-1.65625v5.671873q0 .6875.078125.890625.09375.203125.28125.328125.203125.109375.578125.109375.265625.0.71875-.0625zm.99580383-3.374998q0-2.6875 1.484375-3.96875 1.25-1.078125 3.046875-1.078125 2 0 3.265625 1.3125 1.265625 1.296875 1.265625 3.609375.0 1.859375-.5625 2.937498-.5625 1.0625-1.640625 1.65625-1.0625.59375-2.328125.59375-2.03125.0-3.28125-1.296875-1.25-1.3125-1.25-3.765623zm1.6875.0q0 1.8593731.796875 2.796873.8125.921875 2.046875.921875 1.21875.0 2.03125-.921875.8125-.9375.8125-2.843748.0-1.796875-.8125-2.71875t-2.03125-.921875q-1.234375.0-2.046875.921875-.796875.90625-.796875 2.765625zm9.281967 4.843748v-9.671873h1.46875v1.46875q.5625-1.03125 1.03125-1.359375.484375-.328125 1.0625-.328125.828125.0 1.6875.53125l-.5625 1.515625q-.609375-.359375-1.203125-.359375-.546875.0-.96875.328125t-.609375.890625q-.28125.875-.28125 1.921875v5.062498h-1.625zm12.853302-3.109373 1.6875.2031231q-.40625 1.484375-1.484375 2.3125-1.078125.8125-2.765625.8125-2.125.0-3.375-1.296875-1.234375-1.3125-1.234375-3.671873.0-2.453125 1.25-3.796875 1.265625-1.34375 3.265625-1.34375 1.9375.0 3.15625 1.328125 1.234375 1.3125 1.234375 3.703125.0.15625.0.4375h-7.21875q.09375 1.5937481.90625 2.453123.8125.84375 2.015625.84375.90625.0 1.546875-.46875.640625-.484375 1.015625-1.5156231zm-5.390625-2.65625h5.40625q-.109375-1.21875-.625-1.828125-.78125-.953125-2.03125-.953125-1.125.0-1.90625.765625-.765625.75-.84375 2.015625zm15.406967 5.765623v-1.21875q-.90625 1.4375-2.703125 1.4375-1.15625.0-2.125-.640625t-1.5-1.78125q-.53125-1.1406231-.53125-2.624998.0-1.453125.484375-2.625.484375-1.1875 1.4375-1.8125.96875-.625 2.171875-.625.875.0 1.546875.375.6875.359375 1.109375.953125v-4.796875h1.640625v13.359373h-1.53125zm-5.171875-4.828123q0 1.8593731.78125 2.781248.78125.921875 1.84375.921875 1.078125.0 1.828125-.875.75-.890625.75-2.687498.0-1.984375-.765625-2.90625-.765625-.9375-1.890625-.9375-1.078125.0-1.8125.890625t-.734375 2.8125zm24.793411 3.390623q1.234375.859375 2.265625 1.25l-.515625 1.21875q-1.4375-.515625-2.875-1.625-1.484375.828125-3.28125.828125-1.8125.0-3.2968903-.875-1.46875-.875-2.265625-2.453123-.796875-1.59375-.796875-3.578125t.796875-3.59375q.8125-1.625 2.28125-2.46875 1.4843903-.859375 3.3281403-.859375t3.328125.890625q1.484375.875 2.265625 2.453125t.78125 3.5625q0 1.65625-.5 2.96875-.5 1.3124981-1.515625 2.281248zm-3.890625-2.249998q1.53125.421875 2.515625 1.2812481 1.5625-1.4218731 1.5625-4.281248.0-1.625-.546875-2.828125-.546875-1.21875-1.609375-1.875-1.0625-.671875-2.390625-.671875-1.96875.0-3.2812653 1.359375-1.296875 1.34375-1.296875 4.03125.0 2.59375 1.28125 3.999998 1.2968903 1.390625 3.2968903 1.390625.953125.0 1.78125-.359375-.828125-.53125-1.75-.765625l.4375-1.2812481zm14.402039 3.687498v-1.421875q-1.125 1.640625-3.0625 1.640625-.859375.0-1.609375-.328125-.734375-.328125-1.09375-.828125t-.5-1.21875q-.109375-.46875-.109375-1.5312481v-5.984375h1.640625v5.359375q0 1.2812481.109375 1.7343731.15625.640625.65625 1.015625t1.234375.375 1.375-.375q.65625-.390625.921875-1.03125.265625-.6562481.265625-1.8906231v-5.1875h1.640625v9.671873h-1.46875zm10.672607-3.109373 1.6875.2031231q-.40625 1.484375-1.484375 2.3125-1.078125.8125-2.765625.8125-2.125.0-3.375-1.296875-1.234375-1.3125-1.234375-3.671873.0-2.453125 1.25-3.796875 1.265625-1.34375 3.265625-1.34375 1.9375.0 3.15625 1.328125 1.234375 1.3125 1.234375 3.703125.0.15625.0.4375h-7.21875q.09375 1.5937481.90625 2.453123.8125.84375 2.015625.84375.90625.0 1.546875-.46875.640625-.484375 1.015625-1.5156231zm-5.390625-2.65625h5.40625q-.109375-1.21875-.625-1.828125-.78125-.953125-2.03125-.953125-1.125.0-1.90625.765625-.765625.75-.84375 2.015625zm9.125702 5.765623v-9.671873h1.46875v1.46875q.5625-1.03125 1.03125-1.359375.484375-.328125 1.0625-.328125.828125.0 1.6875.53125l-.5625 1.515625q-.609375-.359375-1.203125-.359375-.546875.0-.96875.328125t-.609375.890625q-.28125.875-.28125 1.921875v5.062498h-1.625zm6.150177 3.71875-.1875-1.53125q.546875.140625.9375.140625.546875.0.875-.1875.328125-.171875.546875-.5.15625-.25.5-1.21875.046875-.140625.140625-.40625l-3.671875-9.687498h1.765625l2.015625 5.59375q.390625 1.0781231.703125 2.249998.28125-1.125.671875-2.203123l2.078125-5.640625h1.640625l-3.6875 9.828123q-.59375 1.609375-.921875 2.203125-.4375.8125-1 1.1875t-1.34375.375q-.484375.0-1.0625-.203125z" fill-rule="nonzero"/></g></svg></div><figcaption><a class=image-link href=3.svg><i class="fa fa-download"></i></a>
image</figcaption></figure></p><p>The plugin is given a subquery which is also a VQL query generating its
own events. As the subquery generates events, each event is kept in the
fifo plugin's cache in a first in first out manner. Events are also
expired if they are too old.</p><p>We typically store the query in a variable. Each time the variable is
queried the cache is returned at once. To illustrate how this works
consider the following query:</p><pre><code class=language-{.sourceCode>LET fifo_events = SELECT * FROM fifo(
  max_rows=5,
  query={
     SELECT * from watch_evtx(filename=securityLogFile)
     WHERE System.EventID.Value = 4625
   })

SELECT * FROM foreach(
   row={
     SELECT * FROM clock(period=60)
   },
   query={
     SELECT * from fifo_events
   })
</code></pre><p>The first query is stored into the fifo_events variable. When it is
first defined, the fifo() VQL plugin launches its subquery and simply
collects its output into its local cache in a fifo manner. This will
essentially keep the last 5 rows in its cache.</p><p>The second query runs the clock() plugin to receive a clock event every
60 seconds. For each of these events, we select from the fifo_events
variable - that is we select the last 5 failed events.</p><p>You can see that this allows us to query the last 5 events in the fifo
cache for every clock event. If we now replace the clock event with a
successful logon event this query will do exactly what we want:</p><pre><code class=language-{.sourceCode># This query will generate failed logon events - one per row, as
# they occur.
- LET failed_logon = SELECT EventData as FailedEventData,
     System as FailedSystem
  FROM watch_evtx(filename=securityLogFile)
  WHERE System.EventID.Value = 4625

# This query will create a fifo() to contain the last 5 failed
# logon events.
- LET last_5_events = SELECT FailedEventData, FailedSystem
      FROM fifo(query=failed_logon,
                max_rows=5,
                max_age=atoi(string=failedLogonTimeWindow))

# This query simply generates successful logon events.
- LET success_logon = SELECT EventData as SuccessEventData,
     System as SuccessSystem
  FROM watch_evtx(filename=securityLogFile)
  WHERE System.EventID.Value = 4624

# For each successful event, we select the last 5 failed events
# and count them (using the group by). If the count is greater
# than 3 then we emit the row as an event.
- SELECT * FROM foreach(
    row=success_logon,
    query={
     SELECT SuccessSystem.TimeCreated.SystemTime AS LogonTime,
            SuccessSystem, SuccessEventData, FailedEventData,
            FailedSystem, count(items=SuccessSystem) as Count
     FROM last_5_events
     WHERE FailedEventData.SubjectUserName = SuccessEventData.SubjectUserName
     GROUP BY LogonTime
    })  WHERE Count &gt; 3
</code></pre><p>The above query simply watches the event log for failed logins and
populates a fifo() with the last 5 failed events. At the same time we
monitor the event log for successful logon events. If we see a
successful event, we go back and check the last 5 failed events and
count them.</p><p>If the failed events are for the same user and there are more than 3
then we report this as an event. We now have a high value event.</p><p>Let's see what it looks like when such an event is triggered:</p><p><figure id=10fb15c77258a991b0028080a64fb42d><div data-featherlight=#10fb15c77258a991b0028080a64fb42d class=figure><img src=3.png alt=image></div><figcaption><a class=image-link href=3.png><i class="fa fa-download"></i></a>
image</figcaption></figure></p><p>Just like before, the events are written to a daily CSV log, one event
per CSV row. It is a bit hard to see in the GUI since there is a lot of
data, (We probably need some GUI work to improve this) but there is a
single row emitted for each event, and the FailedEventData column
contains a list of all the failed login attempts stored in the fifo().</p><h1 id=server-side-queries>Server side queries.</h1><p>We have seen how the fifo() plugin can be used in the monitoring
artifact itself to have the client detect its own events. However, the
endpoint is usually only able to see its own events in isolation. It
would be nice to be able to detect patterns only evident by seeing
concerted behaviour from multiple endpoints at the same time.</p><p>For example, consider the pattern of an attacker who compromised domain
credentials running multiple PowerShell Remoting commands across the
entire domain. A command like:</p><pre><code class=language-{.sourceCode>PS C:\WINDOWS\system32&gt; Invoke-Command â€“ComputerName testcomputer -ScriptBlock {Hostname}
TestComputer
</code></pre><p>This command will generate multiple event log entries, including event
4624 (logon) on each host. While in isolation, on each individual
endpoint this event is not suspicious, we might consider seeing this
event repeated within a short time across the domain suspicious.</p><p>To set that up we would run the following artifact as a monitoring
artifact on all endpoints:</p><pre><code class=language-{.sourceCode>name: Windows.Event.SuccessfulLogon
sources:
 - queries:
   - SELECT EventData as SuccessEventData,
        System as SuccessSystem
     FROM watch_evtx(filename=securityLogFile)
     WHERE System.EventID.Value = 4624
</code></pre><p>On the server we simple install a watcher on all monitoring events from
this artifact and feed the result to the fifo(). This fills the fifo()
with the last 500 successful logon events from all clients within the
last 60 seconds:</p><pre><code class=language-{.sourceCode>LET last_successful_logons = SELECT * FROM fifo(
   max_rows=500,
   max_time=60,
   query={
     SELECT * FROM watch_monitoring(
        artifact=&quot;Windows.Event.SuccessfulLogon&quot;)
   })
</code></pre><p>By counting the number of such unique events we can determine if there
were too many successful logon events from different hosts within the
last minute. This might indicate a scripted use of powershell remoting
across the domain.</p><h1 id=conclusions>Conclusions</h1><p>In this post we have seen how to write artifacts which capture a time
ordered pattern of behavior. This technique is useful to codify common
attack techniques. The technique is general and we can use the same idea
on server side queries to correlate events from many hosts at the same
time.</p><footer class=footline></footer></div></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1772163119></script><script src=/js/perfect-scrollbar.min.js?1772163119></script><script src=/js/perfect-scrollbar.jquery.min.js?1772163119></script><script src=/js/jquery.sticky.js?1772163119></script><script src=/js/featherlight.min.js?1772163119></script><script src=/js/highlight.min.js?1772163119></script><script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1772163119></script><script src=/js/learn.js?1772163119></script><script src=/js/hugo-learn.js?1772163119></script></body></html>