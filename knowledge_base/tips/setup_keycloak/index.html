<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.139.4"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>How to set up OIDC authentication using Keycloak :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1772163125 rel=stylesheet><link href=/css/font-awesome-all.min.css?1772163125 rel=stylesheet><link href=/css/featherlight.min.css?1772163125 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1772163125 rel=stylesheet><link href=/css/auto-complete.css?1772163125 rel=stylesheet><link href=/css/theme.css?1772163125 rel=stylesheet><link href=/css/tabs.css?1772163125 rel=stylesheet><link href=/css/hugo-theme.css?1772163125 rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css integrity=sha384-WcoG4HRXMzYzfCgiyfrySxx90XSl2rxY5mnVY5TwtWE6KLrArNKn0T/mOgNL0Mmi crossorigin=anonymous><link href=/css/theme-mine.css?1772163125 rel=stylesheet><link href=/css/dark.css?1772163125 rel=stylesheet><link href=/css/syntax.css?1772163125 rel=stylesheet><link href=/css/light.css?1772163125 rel=stylesheet><link href=/css/hljs.css?1772163125 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1772163125 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1772163125></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS")}</script><script></script></head><body data-url=/knowledge_base/tips/setup_keycloak/><nav id=sidebar><div id=header-wrapper><div id=header><a href=https://docs.velociraptor.app/><img class="logo dark" src=https://docs.velociraptor.app//images/VeloR7_DarkMode.svg>
<img class="logo light" src=https://docs.velociraptor.app//images/VeloR7_LightMode.svg></a><div class="ThemeSelector darkmode"><i class="fas fa-moon"></i></div><div class="ThemeSelector lightmode"><i class="fas fa-sun"></i></div><script>const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?$("body").addClass("dark").removeClass("light"):$("body").addClass("light").removeClass("dark"),$(".ThemeSelector.darkmode").on("click",function(){return $("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/",!1}),$(".ThemeSelector.lightmode").on("click",function(){return $("body").addClass("light").removeClass("dark"),document.cookie="theme=lightmode;path=/",!1})</script></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/><i class="fas fa-exclamation-triangle"></i>Security Advisories</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2025-14728/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2025-14728/>CVE-2025-14728</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2025-6264/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2025-6264/>CVE-2025-6264</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2025-0914/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2025-0914/>CVE-2025-0914</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2024-10526/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2024-10526/>CVE-2024-10526</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-5950/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2023-5950/>CVE-2023-5950</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-2226/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2023-2226/>CVE-2023-2226</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0242/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2023-0242/>CVE-2023-0242</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/advisories/cve-2023-0290/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/announcements/advisories/cve-2023-0290/>CVE-2023-0290</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/overview/support/>Support Policy</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/security/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/overview/security/>Security</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/quickstart/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/quickstart/>Quickstart</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/>Server Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/key_concepts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/key_concepts/>Key Concepts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/key_decisions/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/key_decisions/>Key Decisions</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/deployment_example/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/deployment_example/>Deployment Example</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/multifrontend/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/multifrontend/>Multi-Frontend</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/server/upgrades/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/server/upgrades/>Upgrades</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/orgs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/orgs/>Organizations</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/>Offline Collections</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/building/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/building/>Building</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/running/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/running/>Running</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/collection_data/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/collection_data/>Collection Data</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/updating/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/updating/>Updating</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/offline_collections/troubleshooting/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/offline_collections/troubleshooting/>Troubleshooting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/security/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/deployment/references/><i class="fas fa-book"></i>Config Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/>The Admin GUI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/artifacts/>Managing Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/keyboard_shortcuts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/keyboard_shortcuts/>Keyboard Shortcuts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/user_preferences/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/user_preferences/>User Preferences</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/customizing/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/gui/customizing/>Customization</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/>Managing Clients</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/clients/searching/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/searching/>Searching for clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/interrogation/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/interrogation/>Interrogation</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/artifacts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/artifacts/>Collecting Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/labels/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/labels/>Labels</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/metadata/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/metadata/>Metadata</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/quarantine/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/quarantine/>Quarantine</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/vfs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/vfs/>Virtual File System</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/shell/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/shell/>Shell Commands</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/clients/monitoring/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/clients/monitoring/>Monitoring</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/>VQL</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/fundamentals/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/fundamentals/>VQL Fundamentals</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/events/>Event Queries</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/join/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/join/>JOIN in VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/artifacts/>Artifacts</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/calling/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/artifacts/calling/>Calling Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/managing/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/artifacts/managing/>Managing Artifacts</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/extending_vql/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/vql_reference/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/vql/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/>Artifacts</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/managing/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/managing/>Managing Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/basic_fields/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/basic_fields/>Basic Fields</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/advanced_fields/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/advanced_fields/>Advanced Fields</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/parameters/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/parameters/>Parameters</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/sources/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/sources/>Sources</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/preconditions/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/preconditions/>Preconditions</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/export_imports/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/export_imports/>Export & Imports</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/calling_artifacts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/calling_artifacts/>Calling Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/event_queues/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/event_queues/>Event Queues</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/tools/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/tools/>Tools</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/resources/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/resources/>Resource Limits</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/security/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/use_cases/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/use_cases/>Other Use Cases</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/tips/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/tips/>Artifact Writing Tips</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/artifact_reference/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/artifact_reference/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/artifacts/exchange_reference/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/artifacts/exchange_reference/><i class="fas fa-code"></i>Artifact Exchange</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/notebooks/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/hunting/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/hunting/>Hunting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/filesystem/>Searching Filesystems</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/paths/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/filesystem/paths/>Velociraptor Paths</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/remapping/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/filesystem/remapping/>Remapping Accessors</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ntfs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/filesystem/ntfs/>NTFS Analysis</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/deaddisk/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/deaddisk/>Dead Disk Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/deaddisk/creating_running/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/deaddisk/creating_running/>Creating & Running</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/file_collection/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/file_collection/>File Acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/file_collection/bulk/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/file_collection/bulk/>Bulk File Acquisition</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/file_collection/vfs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/file_collection/vfs/>VFS Uploads</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/file_collection/exporting/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/file_collection/exporting/>Bulk File Exports</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/>CLI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/cli/acl/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/acl/>acl</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/artifacts/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/artifacts/>artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/collector/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/collector/>collector</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/config/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/config/>config</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/deaddisk/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/deaddisk/>deaddisk</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/fs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/fs/>fs (filesystem)</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/fuse/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/fuse/>fuse</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/query/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/query/>query</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/server_service/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/server_service/>server_service</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/service/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/service/>service</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/tools/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/tools/>tools</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/user/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/user/>user</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/misc/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/misc/>Miscellaneous</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/cli/flags/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/cli/flags/>CLI flags</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/>Troubleshooting</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/deployment/server/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/deployment/server/>Server</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/deployment/client/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/deployment/client/>Client</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/deployment/offline_collector/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/deployment/offline_collector/>Offline Collector</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/operations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/operations/>Operations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/operations/server_ops/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/operations/server_ops/>Server Ops</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/operations/remote_clients/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/operations/remote_clients/>Remote Clients</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/vql/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/vql/>VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/>Debugging</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/internal/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/internal/>Internal</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/internal/metrics/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/internal/metrics/>Metrics</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/internal/go_profiles/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/internal/go_profiles/>Golang</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/client/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/client/>Client</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/client/client_monitoring/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/client/client_monitoring/>Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/client/client_flows/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/client/client_flows/>Flows</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/>Global</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/datastore/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/datastore/>Datastore</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/datastore/replication/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/datastore/replication/>Replication</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/>Services</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/export/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/export/>ExportContainers</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/throttler/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/throttler/>Throttler</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/user_manager/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/user_manager/>User Manager</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/open_close/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/open_close/>Open-close</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/tempfiles/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/tempfiles/>tempfiles</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/services/worker/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/services/worker/>worker</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/>VQL</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/queries/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/queries/>Queries</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/queries/active_queries/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/queries/active_queries/>Active Queries</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/queries/plugin_monitor/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/queries/plugin_monitor/>Plugin Monitor</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/queries/recent_queries/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/queries/recent_queries/>Recent Queries</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/>Plugins</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/etw/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/etw/>ETW</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/glob/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/glob/>Glob</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/ntfs/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/ntfs/>NTFS Cache</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/sigma/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/sigma/>Sigma Tracker</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/windows_event/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/windows_event/>Windows Event Log Watcher</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/zip/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/zip/>Zip</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/process/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/process/>Process Tracker</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/global/vql/plugins/sqlite/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/global/vql/plugins/sqlite/>Sqlite</a></div></li></ul></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/>Org</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/>Services</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/broadcast_service/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/broadcast_service/>Broadcast</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/queue_manager/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/queue_manager/>QueueManager</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/vfs_service/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/vfs_service/>VFS</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/troubleshooting/debugging/org/services/notifier/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/docs/troubleshooting/debugging/org/services/notifier/>Notifier</a></div></li></ul></li></ul></li></ul></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/downloads/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/downloads/><i class="fas fa-download"></i>Downloads</a></div></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/popular/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/popular/>Frequently Used âœ¨</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/windows/>Windows-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/linux/>Linux-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/server/>Server-only</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/encode/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/encode/>Encode/Decode</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/developer/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/developer/>Developer</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/other/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/other/>Other</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/accessors/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/vql_reference/accessors/>Accessors</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div><ul><li data-nav-id=https://docs.velociraptor.app/training/playbooks/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/training/playbooks/><i class="fas fa-play"></i>Playbooks</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_velocon/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2023_velocon/>VeloCON 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2024_auscert/>Auscert 2024</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2024_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2024_auscert-detection-engineering/>Auscert 2024 Talk</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2025_auscert-detection-engineering/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/presentations/2025_auscert-detection-engineering/>Auscert 2025 Workshop</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item parent haschildren"><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-chevron-right fa-sm category-icon"></i>
<a rel=nofollow href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a rel=nofollow class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>GitHub</a></li><li><a rel=nofollow class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a rel=nofollow class=padding href=https://docs.velociraptor.app/youtube/><i class='fab fa-youtube'></i>YouTube</a></li><li><a rel=nofollow class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a rel=nofollow class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li><li><a rel=nofollow class=padding href=https://docs.rapid7.com/insightidr/velociraptor-integration/><i class='fa fa-question-circle'></i>Rapid7 Docs</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2025</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/knowledge_base/tips/setup_keycloak.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links itemprop=itemListElement itemscope itemtype=http://schema.org/ListItem><span itemprop=item><span itemprop=name>How to set up OIDC authentication using Keycloak</span></span>
<meta itemprop=position content="1"></span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#create-a-docker-based-keycloak-instance>Create a Docker-based Keycloak instance</a></li><li><a href=#configure-keycloak>Configure Keycloak</a></li><li><a href=#configure-velociraptor>Configure Velociraptor</a></li><li><a href=#add-test-users>Add test users</a></li><li><a href=#test-authentication-process>Test authentication process</a></li><li><a href=#what-next>What next?</a></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/configuration>configuration</a>
<a class=tag-link href=/tags/sso>sso</a>
<a class=tag-link href=/tags/deployment>deployment</a></div></div><div id=body-inner><h1 id=how-to-set-up-oidc-authentication-using-keycloak>How to set up OIDC authentication using Keycloak</h1><p>This guide walks you through the configuration of
<a href=https://www.keycloak.org/ target=_blank>Keycloak</a>
as an OIDC authentication provider for
Velociraptor.</p><p>Keycloak, as a self-hosted, free, and open source solution, may be an attractive
choice for Velociraptor deployments where using cloud-based and/or commercial
providers is not practical or possible. Most of the steps shown here would be
the same or similar for other self-hosted OIDC solutions (for example Zitadel or
Authentik), so it may be useful even if you are not using Keycloak.</p><div class="mynotices warning"><div heading=" Production deployment of Keycloak "><p>Keycloak is a Java application which can be installed manually or deployed via
several officially documented container-based methods. This guide partly mirrors Keycloak&rsquo;s
<a href=https://www.keycloak.org/getting-started/getting-started-docker target=_blank>Getting started guide</a>
which uses Docker to create a <em>&ldquo;development mode&rdquo; instance</em> of Keycloak. This
method starts a working Keycloak instance but does not create a persistent
database or a production-ready secured server, since the goal here is only to
demonstrate the integration with Velociraptor.</p><p>For production-ready deployment guidance we refer you to
<a href=https://www.keycloak.org/server/configuration-production target=_blank>Configuring Keycloak for production</a>
and the official <a href=https://www.keycloak.org/documentation target=_blank>Keycloak documentation</a>
.</p></div></div><p>As mentioned above, the goal of this guide is to demonstrate a working SSO
configuration for Velociraptor using Keycloak. The basic steps and configuration
will be very similar or even identical for production deployments however some
of the steps shown here are deliberately over-simplified for reasons of brevity
and therefore do not reflect security best practices. Also Keycloak has a vast
array of options and capabilities, which we recommend you explore later, but the
intention here is to get up and running with a basic working integration since
it is better to start simple and be sure that it&rsquo;s working as expected before
possibly adding complexity to it.</p><p>In this simplified setup we have two hosts, with DNS names <code>keycloak.local</code> and
<code>velociraptor.local</code>. Substitute your DNS names where applicable. The two hosts
don&rsquo;t need to be on the same network but the Velociraptor host needs to be able
to DNS-resolve the name of the Keycloak server and reach it on port 443. It&rsquo;s
not necessary that the Keycloak server be able to resolve the Velociraptor
server&rsquo;s DNS name but your server probably already has a DNS name already so
that clients can connect to it.</p><p><figure id=d1d61019841b4ed3a43cafc19e745e56><div data-featherlight=#d1d61019841b4ed3a43cafc19e745e56 class=figure><svg viewBox="0 0 658.5 380" width="658.5" height="380"><defs/><g transform="translate(448.5 77.5) rotate(0 90 12.5)"><text x="90" y="17.619999999999997" font-family="Excalifont, Xiaolai, Segoe UI Emoji" font-size="20" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" direction="ltr" dominant-baseline="alphabetic">velociraptor.local</text></g><g stroke-linecap="round" transform="translate(428.5 50) rotate(0 110 40)"><path d="M20 0C88.57-.88 160.01-1.61 2e2.0M20 0C58.54-1.53 98.43-.46 2e2.0m0 0c11.69 1.33 20.42 6.57 20 20M2e2.0c11.6.43 17.78 6.44 20 20m0 0C220.28 32.33 220.74 47.02 220 60m0-40C220.42 29.27 219.9 37.09 220 60m0 0C219.25 73.02 212.98 81.3 2e2 80m20-20C219.38 74.64 213.91 78.45 2e2 80m0 0c-41.36 2.64-88.14 2.36-180 0m180 0C129.17 77.64 58.47 78.32 20 80m0 0C7.8 79.81-1.25 74.46.0 60M20 80C4.42 78.88 2.09 75.29.0 60m0 0c-2.04-8.54.64-22.2.0-40M0 60C-.59 44.56.99 28.68.0 20m0 0C-1.89 6 5.69.76 20 0M0 20C.34 5.1 7.14-2.09 20 0" stroke="#1e1e1e" stroke-width="2" fill="none"/></g><g transform="translate(18.5 77.5) rotate(0 101.5 12.5)"><text x="101.49999999999999" y="17.619999999999997" font-family="Excalifont, Xiaolai, Segoe UI Emoji" font-size="20" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" direction="ltr" dominant-baseline="alphabetic">keycloak.local</text></g><g stroke-linecap="round" transform="translate(10 50) rotate(0 110 40)"><path d="M20 0C76.96-.66 132.14-.78 2e2.0M20 0c42.04.37 84.12.24 180 0m0 0c13.23 1.37 20.57 6.48 20 20M2e2.0c13.56 2 21.3 6.97 20 20m0 0C221.55 28.63 219.47 39.69 220 60m0-40C219.3 31.71 219.58 43.2 220 60m0 0C219.26 74.79 212.38 80.88 2e2 80m20-20C218.17 75.49 215.12 79.31 2e2 80m0 0C131.97 80.13 62.31 80.12 20 80m180 0C130.24 82.46 58.61 81.1 20 80m0 0C6.8 81-.91 73.89.0 60M20 80C6.95 81.88.47 74.89.0 60m0 0C-1.01 48.08-1 40.08.0 20M0 60C.26 44.86-.6 30.27.0 20m0 0C-1.4 7.51 7.67-.6 20 0M0 20C2.15 5.2 5.79.48 20 0" stroke="#1e1e1e" stroke-width="2" fill="none"/></g><g stroke-linecap="round"><g transform="translate(241.01502374283154 88.96543240222326) rotate(0 84.74741701882738 -0.9890726441210518)"><path d="M-.5-.03c14.93-.13 61.29-1.8 89.82-1.95 28.54-.14 68.18.96 81.37 1.08" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"/></g><g transform="translate(241.01502374283154 88.96543240222326) rotate(0 84.74741701882738 -0.9890726441210518)"><path d="M22.77-9.15C17.92-6.07 8.15-2.18-.5-.03" stroke="#1e1e1e" stroke-width="2.5" fill="none"/></g><g transform="translate(241.01502374283154 88.96543240222326) rotate(0 84.74741701882738 -0.9890726441210518)"><path d="M23.19 7.95C18.25 6.28 8.36 5.41-.5-.03" stroke="#1e1e1e" stroke-width="2.5" fill="none"/></g></g><mask/><g stroke-linecap="round"><g transform="translate(435.5 228) rotate(0 23 -40)"><path d="M.74.88C4.55-5.76 15.38-25.94 22.89-39.54c7.52-13.59 18.98-34.51 22.95-41.13M-.33.3C3.31-6.22 14.34-24.95 21.89-38.28c7.56-13.33 18.86-34.23 23.1-41.42" stroke="#1e1e1e" stroke-width="2" fill="none"/></g><g transform="translate(435.5 228) rotate(0 23 -40)"><path d="M41.11-56.52c2.57-7.2 1.38-14.29 3.88-23.18M41.11-56.52C41.65-62.21 43.78-68.79 44.99-79.7" stroke="#1e1e1e" stroke-width="2" fill="none"/></g><g transform="translate(435.5 228) rotate(0 23 -40)"><path d="M27.11-64.44c6.83-4.89 9.86-9.59 17.88-15.26M27.11-64.44C31.13-68.28 36.67-72.93 44.99-79.7" stroke="#1e1e1e" stroke-width="2" fill="none"/></g></g><mask/><g transform="translate(50 10) rotate(0 70 10)"><text x="70" y="14.096" font-family="Excalifont, Xiaolai, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" direction="ltr" dominant-baseline="alphabetic">OIDC Provider</text></g><g transform="translate(468.5 10) rotate(0 70 10)"><text x="70" y="14.096" font-family="Excalifont, Xiaolai, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" direction="ltr" dominant-baseline="alphabetic">OIDC Client</text></g><g stroke-linecap="round" transform="translate(345.6143342216468 250) rotate(0 63.941917866069446 38.268516949888806)"><path d="M0 0C50.92-1.01 99.18.86 127.88.0M0 0C27.22-.35 52.93-1.09 127.88.0m0 0C129 14.97 127.16 33.27 127.88 76.54m0-76.54C128.45 25.83 128.67 51.78 127.88 76.54m0 0C79.19 75.12 34.34 75.28.0 76.54m127.88.0C80.11 76.62 32.38 76.24.0 76.54m0 0C-.1 48.8-.34 17.81.0.0M0 76.54C1.01 56.33 1.2 35.69.0.0" stroke="#000" stroke-width="1" fill="none"/></g><g stroke-linecap="round"><g transform="translate(344.5387364707516 260.71653439224417) rotate(0 64.42096614922218 0)"><path d="M-1.04-.51c21.6-.28 108.18-.79 129.96-.62M.62-1.82c21.51-.22 105.95 1.6 127.4 1.63" stroke="#000" stroke-width="1" fill="none"/></g></g><mask/><g stroke-linecap="round" transform="translate(350.1023696906017 254.27156980000882) rotate(0 2.5009765625 2.5009765625)"><path d="M5 2.5C5 2.65 4.99 2.79 4.96 2.94 4.94 3.08 4.9 3.22 4.85 3.36 4.8 3.49 4.74 3.63 4.67 3.75 4.59 3.88 4.51 4 4.42 4.11 4.32 4.22 4.22 4.32 4.11 4.42 4 4.51 3.88 4.59 3.75 4.67 3.63 4.74 3.49 4.8 3.36 4.85 3.22 4.9 3.08 4.94 2.94 4.96 2.79 4.99 2.65 5 2.5 5 2.36 5 2.21 4.99 2.07 4.96 1.92 4.94 1.78 4.9 1.65 4.85 1.51 4.8 1.38 4.74 1.25 4.67 1.13 4.59 1 4.51.89 4.42.78 4.32.68 4.22.59 4.11.49 4 .41 3.88.34 3.75.26 3.63.2 3.49.15 3.36.1 3.22.06 3.08.04 2.94.01 2.79.0 2.65.0 2.5c0-.14.01-.29.04-.43.02-.15.06-.29.11-.42.05-.14.11-.27.19-.4C.41 1.13.49 1 .59.89.68.78.78.68.89.59c.11-.1.24-.18.36-.25.13-.08.26-.14.4-.19.13-.05.27-.09.42-.11C2.21.01 2.36.0 2.5.0c.15.0.29.01.44.04.14.02.28.06.42.11.13.05.27.11.39.19.13.07.25.15.36.25C4.22.68 4.32.78 4.42.89 4.51 1 4.59 1.13 4.67 1.25 4.74 1.38 4.8 1.51 4.85 1.65 4.9 1.78 4.94 1.92 4.96 2.07 4.99 2.21 5 2.43 5 2.5 5.01 2.57 5.01 2.43 5 2.5" stroke="none" stroke-width="0" fill="#fa5252"/><path d="M5 2.5C5 2.65 4.99 2.79 4.96 2.94 4.94 3.08 4.9 3.22 4.85 3.36 4.8 3.49 4.74 3.63 4.67 3.75 4.59 3.88 4.51 4 4.42 4.11 4.32 4.22 4.22 4.32 4.11 4.42 4 4.51 3.88 4.59 3.75 4.67 3.63 4.74 3.49 4.8 3.36 4.85 3.22 4.9 3.08 4.94 2.94 4.96 2.79 4.99 2.65 5 2.5 5 2.36 5 2.21 4.99 2.07 4.96 1.92 4.94 1.78 4.9 1.65 4.85 1.51 4.8 1.38 4.74 1.25 4.67 1.13 4.59 1 4.51.89 4.42.78 4.32.68 4.22.59 4.11.49 4 .41 3.88.34 3.75.26 3.63.2 3.49.15 3.36.1 3.22.06 3.08.04 2.94.01 2.79.0 2.65.0 2.5c0-.14.01-.29.04-.43.02-.15.06-.29.11-.42.05-.14.11-.27.19-.4C.41 1.13.49 1 .59.89.68.78.78.68.89.59c.11-.1.24-.18.36-.25.13-.08.26-.14.4-.19.13-.05.27-.09.42-.11C2.21.01 2.36.0 2.5.0c.15.0.29.01.44.04.14.02.28.06.42.11.13.05.27.11.39.19.13.07.25.15.36.25C4.22.68 4.32.78 4.42.89 4.51 1 4.59 1.13 4.67 1.25 4.74 1.38 4.8 1.51 4.85 1.65 4.9 1.78 4.94 1.92 4.96 2.07 4.99 2.21 5 2.43 5 2.5 5.01 2.57 5.01 2.43 5 2.5" stroke="#000" stroke-width="1" fill="none"/></g><g stroke-linecap="round" transform="translate(360.3650650031017 254.27156980000882) rotate(0 2.5009765625 2.5009765625)"><path d="M5 2.5C5 2.65 4.99 2.79 4.96 2.94 4.94 3.08 4.9 3.22 4.85 3.36 4.8 3.49 4.74 3.63 4.67 3.75 4.59 3.88 4.51 4 4.42 4.11 4.32 4.22 4.22 4.32 4.11 4.42 4 4.51 3.88 4.59 3.75 4.67 3.63 4.74 3.49 4.8 3.36 4.85 3.22 4.9 3.08 4.94 2.94 4.96 2.79 4.99 2.65 5 2.5 5 2.36 5 2.21 4.99 2.07 4.96 1.92 4.94 1.78 4.9 1.65 4.85 1.51 4.8 1.38 4.74 1.25 4.67 1.13 4.59 1 4.51.89 4.42.78 4.32.68 4.22.59 4.11.49 4 .41 3.88.34 3.75.26 3.63.2 3.49.15 3.36.1 3.22.06 3.08.04 2.94.01 2.79.0 2.65.0 2.5c0-.14.01-.29.04-.43.02-.15.06-.29.11-.42.05-.14.11-.27.19-.4C.41 1.13.49 1 .59.89.68.78.78.68.89.59c.11-.1.24-.18.36-.25.13-.08.26-.14.4-.19.13-.05.27-.09.42-.11C2.21.01 2.36.0 2.5.0c.15.0.29.01.44.04.14.02.28.06.42.11.13.05.27.11.39.19.13.07.25.15.36.25C4.22.68 4.32.78 4.42.89 4.51 1 4.59 1.13 4.67 1.25 4.74 1.38 4.8 1.51 4.85 1.65 4.9 1.78 4.94 1.92 4.96 2.07 4.99 2.21 5 2.43 5 2.5 5.01 2.57 5.01 2.43 5 2.5" stroke="none" stroke-width="0" fill="#fab005"/><path d="M5 2.5C5 2.65 4.99 2.79 4.96 2.94 4.94 3.08 4.9 3.22 4.85 3.36 4.8 3.49 4.74 3.63 4.67 3.75 4.59 3.88 4.51 4 4.42 4.11 4.32 4.22 4.22 4.32 4.11 4.42 4 4.51 3.88 4.59 3.75 4.67 3.63 4.74 3.49 4.8 3.36 4.85 3.22 4.9 3.08 4.94 2.94 4.96 2.79 4.99 2.65 5 2.5 5 2.36 5 2.21 4.99 2.07 4.96 1.92 4.94 1.78 4.9 1.65 4.85 1.51 4.8 1.38 4.74 1.25 4.67 1.13 4.59 1 4.51.89 4.42.78 4.32.68 4.22.59 4.11.49 4 .41 3.88.34 3.75.26 3.63.2 3.49.15 3.36.1 3.22.06 3.08.04 2.94.01 2.79.0 2.65.0 2.5c0-.14.01-.29.04-.43.02-.15.06-.29.11-.42.05-.14.11-.27.19-.4C.41 1.13.49 1 .59.89.68.78.78.68.89.59c.11-.1.24-.18.36-.25.13-.08.26-.14.4-.19.13-.05.27-.09.42-.11C2.21.01 2.36.0 2.5.0c.15.0.29.01.44.04.14.02.28.06.42.11.13.05.27.11.39.19.13.07.25.15.36.25C4.22.68 4.32.78 4.42.89 4.51 1 4.59 1.13 4.67 1.25 4.74 1.38 4.8 1.51 4.85 1.65 4.9 1.78 4.94 1.92 4.96 2.07 4.99 2.21 5 2.43 5 2.5 5.01 2.57 5.01 2.43 5 2.5" stroke="#000" stroke-width="1" fill="none"/></g><g stroke-linecap="round" transform="translate(371.07848146944787 254.722290953855) rotate(0 2.5009765625 2.5009765625)"><path d="M5 2.5C5 2.65 4.99 2.79 4.96 2.94 4.94 3.08 4.9 3.22 4.85 3.36 4.8 3.49 4.74 3.63 4.67 3.75 4.59 3.88 4.51 4 4.42 4.11 4.32 4.22 4.22 4.32 4.11 4.42 4 4.51 3.88 4.59 3.75 4.67 3.63 4.74 3.49 4.8 3.36 4.85 3.22 4.9 3.08 4.94 2.94 4.96 2.79 4.99 2.65 5 2.5 5 2.36 5 2.21 4.99 2.07 4.96 1.92 4.94 1.78 4.9 1.65 4.85 1.51 4.8 1.38 4.74 1.25 4.67 1.13 4.59 1 4.51.89 4.42.78 4.32.68 4.22.59 4.11.49 4 .41 3.88.34 3.75.26 3.63.2 3.49.15 3.36.1 3.22.06 3.08.04 2.94.01 2.79.0 2.65.0 2.5c0-.14.01-.29.04-.43.02-.15.06-.29.11-.42.05-.14.11-.27.19-.4C.41 1.13.49 1 .59.89.68.78.78.68.89.59c.11-.1.24-.18.36-.25.13-.08.26-.14.4-.19.13-.05.27-.09.42-.11C2.21.01 2.36.0 2.5.0c.15.0.29.01.44.04.14.02.28.06.42.11.13.05.27.11.39.19.13.07.25.15.36.25C4.22.68 4.32.78 4.42.89 4.51 1 4.59 1.13 4.67 1.25 4.74 1.38 4.8 1.51 4.85 1.65 4.9 1.78 4.94 1.92 4.96 2.07 4.99 2.21 5 2.43 5 2.5 5.01 2.57 5.01 2.43 5 2.5" stroke="none" stroke-width="0" fill="#40c057"/><path d="M5 2.5C5 2.65 4.99 2.79 4.96 2.94 4.94 3.08 4.9 3.22 4.85 3.36 4.8 3.49 4.74 3.63 4.67 3.75 4.59 3.88 4.51 4 4.42 4.11 4.32 4.22 4.22 4.32 4.11 4.42 4 4.51 3.88 4.59 3.75 4.67 3.63 4.74 3.49 4.8 3.36 4.85 3.22 4.9 3.08 4.94 2.94 4.96 2.79 4.99 2.65 5 2.5 5 2.36 5 2.21 4.99 2.07 4.96 1.92 4.94 1.78 4.9 1.65 4.85 1.51 4.8 1.38 4.74 1.25 4.67 1.13 4.59 1 4.51.89 4.42.78 4.32.68 4.22.59 4.11.49 4 .41 3.88.34 3.75.26 3.63.2 3.49.15 3.36.1 3.22.06 3.08.04 2.94.01 2.79.0 2.65.0 2.5c0-.14.01-.29.04-.43.02-.15.06-.29.11-.42.05-.14.11-.27.19-.4C.41 1.13.49 1 .59.89.68.78.78.68.89.59c.11-.1.24-.18.36-.25.13-.08.26-.14.4-.19.13-.05.27-.09.42-.11C2.21.01 2.36.0 2.5.0c.15.0.29.01.44.04.14.02.28.06.42.11.13.05.27.11.39.19.13.07.25.15.36.25C4.22.68 4.32.78 4.42.89 4.51 1 4.59 1.13 4.67 1.25 4.74 1.38 4.8 1.51 4.85 1.65 4.9 1.78 4.94 1.92 4.96 2.07 4.99 2.21 5 2.43 5 2.5 5.01 2.57 5.01 2.43 5 2.5" stroke="#000" stroke-width="1" fill="none"/></g><g stroke-opacity=".9" fill-opacity=".9" stroke-linecap="round" transform="translate(387.1055424590751 270.77465983187085) rotate(0 21.360101269687846 21.360101269687846)"><path d="M19.16-.23c4.28-.8 10.46.98 14.26 3.68s7.39 8.01 8.55 12.51C43.12 20.46 42.3 26.41 40.34 30.46c-1.96 4.05-6.13 7.87-10.12 9.82-4 1.95-9.5 2.9-13.82 1.86-4.33-1.04-9.37-4.35-12.13-8.12C1.5 30.24-.42 24.07-.18 19.48c.25-4.59 2.45-9.78 5.91-13C9.19 3.26 18.05 1.14 20.59.19 23.14-.76 20.98.42 21 .77M19.72-.31c4.3-.66 9.54 1.91 13.16 4.5 3.63 2.6 7.15 6.69 8.58 11.08C42.89 19.66 43.3 26.36 41.48 30.54s-6.68 7.95-10.95 9.81c-4.27 1.86-10.37 2.39-14.66 1.37C11.57 40.7 7.29 38 4.74 34.24 2.2 30.48.31 23.84.57 19.18.84 14.51 3.35 9.39 6.33 6.27 9.32 3.14 16.43 1.51 18.5.43 20.58-.65 18.55-.61 18.81-.19" stroke="none" stroke-width="0" fill="#04aaf7"/><path d="M17.44-.08c4.17-1.18 9.98.24 13.98 2.56 4.01 2.31 8.31 7.03 10.06 11.34C43.22 18.13 43.42 24 41.89 28.34c-1.54 4.33-5.62 9.09-9.63 11.5C28.25 42.26 22.34 43.56 17.8 42.83 13.26 42.11 8.01 39.07 5 35.51 1.99 31.94-.29 26.09-.27 21.45c.02-4.64 2.31-10.3 5.37-13.8C8.17 4.15 15.94 1.62 18.14.45 20.34-.73 18.29.28 18.32.6m3.29-.7C25.95-.4 32.14 1.83 35.6 4.73c3.46 2.9 6.09 8.15 6.76 12.59C43.03 21.77 41.79 27.33 39.61 31.41c-2.18 4.09-6.18 8.67-10.31 10.44C25.17 43.63 19.18 43.76 14.83 42.07 10.49 40.38 5.76 35.65 3.25 31.7.75 27.76-.83 22.88-.18 18.42.47 13.95 3.63 8.05 7.15 4.91 10.67 1.77 18.65.43 20.94-.42 23.23-1.27 20.94-.71 20.88-.19" stroke="#000" stroke-width="1" fill="none"/></g><g stroke-linecap="round"><g transform="translate(414.1837065210507 286.9990118963285) rotate(0 -3.3114080732229922 5.9489359900645695)" fill-rule="evenodd"><path d="M0 0C-.31-.07-.57.63-1.83-.41-3.09-1.46-5.98-5.62-7.57-6.27c-1.59-.66-2.95.48-3.79 1.92-.84 1.44-1.27 4.88-1.25 6.72C-12.6 4.22-10.47 5.65-11.27 6.74-12.07 7.83-16.44 7.74-17.42 8.89-18.41 10.04-18.04 12.9-17.2 13.64-16.36 14.39-13.8 14.04-12.38 13.35s2.22-4.63 3.68-3.87c1.46.75 3.7 6.94 5.08 8.39S-.39 20.35-.42 18.17C-.44 15.99-4.08 7.1-3.78 4.8c.3-2.3 4.01-.63 5.17-.45C2.54 4.53 1.85 5.61 3.16 5.87c1.31.25 4.8.87 6.08.0C10.51 5 11.64 1.43 10.8.63c-.83-.79-5.69 1.55-6.58.48C3.34.04 5.78-4.68 5.49-5.76 5.19-6.84 3.43-6.15 2.47-5.35 1.52-4.54.17-1.81-.24-.92c-.41.89.2.77.24.92" stroke="none" stroke-width="0" fill="#40c057" fill-rule="evenodd"/><path d="M0 0C-.31-.07-.57.63-1.83-.41-3.09-1.46-5.98-5.62-7.57-6.27c-1.59-.66-2.95.48-3.79 1.92-.84 1.44-1.27 4.88-1.25 6.72C-12.6 4.22-10.47 5.65-11.27 6.74-12.07 7.83-16.44 7.74-17.42 8.89-18.41 10.04-18.04 12.9-17.2 13.64-16.36 14.39-13.8 14.04-12.38 13.35s2.22-4.63 3.68-3.87c1.46.75 3.7 6.94 5.08 8.39S-.39 20.35-.42 18.17C-.44 15.99-4.08 7.1-3.78 4.8c.3-2.3 4.01-.63 5.17-.45C2.54 4.53 1.85 5.61 3.16 5.87c1.31.25 4.8.87 6.08.0C10.51 5 11.64 1.43 10.8.63c-.83-.79-5.69 1.55-6.58.48C3.34.04 5.78-4.68 5.49-5.76 5.19-6.84 3.43-6.15 2.47-5.35 1.52-4.54.17-1.81-.24-.92c-.41.89.2.77.24.92M0 0C-.31-.07-.57.63-1.83-.41-3.09-1.46-5.98-5.62-7.57-6.27c-1.59-.66-2.95.48-3.79 1.92-.84 1.44-1.27 4.88-1.25 6.72C-12.6 4.22-10.47 5.65-11.27 6.74-12.07 7.83-16.44 7.74-17.42 8.89-18.41 10.04-18.04 12.9-17.2 13.64-16.36 14.39-13.8 14.04-12.38 13.35s2.22-4.63 3.68-3.87c1.46.75 3.7 6.94 5.08 8.39S-.39 20.35-.42 18.17C-.44 15.99-4.08 7.1-3.78 4.8c.3-2.3 4.01-.63 5.17-.45C2.54 4.53 1.85 5.61 3.16 5.87c1.31.25 4.8.87 6.08.0C10.51 5 11.64 1.43 10.8.63c-.83-.79-5.69 1.55-6.58.48C3.34.04 5.78-4.68 5.49-5.76 5.19-6.84 3.43-6.15 2.47-5.35 1.52-4.54.17-1.81-.24-.92c-.41.89.2.77.24.92" stroke="#087f5b" stroke-width="1" fill="none"/></g></g><mask/><g stroke-linecap="round"><g stroke-opacity=".9" fill-opacity=".9" transform="translate(388.1646049331026 291.73753339505186) rotate(0 21.047557886136133 0)"><path d="M.26.28c7-.04 34.35-.49 41.29-.5M-.27-.05c7.19.03 35.82.52 42.78.41" stroke="#000" stroke-width="1" fill="none"/></g></g><mask/><g stroke-linecap="round"><g stroke-opacity=".9" fill-opacity=".9" transform="translate(393.25993396287697 276.30300446808565) rotate(0 14.659303301924297 2.593116626464507)"><path d="M0 0C.13.38.09 1.58.77 2.28c.69.69 2.04 1.4 3.33 1.91 1.3.51 2.54.94 4.44 1.15 1.89.21 4.43.21 6.94.11 2.51-.11 5.96-.17 8.1-.74 2.14-.57 3.78-1.85 4.74-2.68C29.27 1.2 29.15.12 29.32-.26M0 0C.13.38.09 1.58.77 2.28c.69.69 2.04 1.4 3.33 1.91 1.3.51 2.54.94 4.44 1.15 1.89.21 4.43.21 6.94.11 2.51-.11 5.96-.17 8.1-.74 2.14-.57 3.78-1.85 4.74-2.68C29.27 1.2 29.15.12 29.32-.26" stroke="#000" stroke-width="1" fill="none"/></g></g><mask/><g stroke-opacity=".9" fill-opacity=".9" stroke-linecap="round" transform="translate(401.33384988679643 269.39213020227817) rotate(0 7.764217176558077 22.41115194065469)"><path d="M8.39.35c1.48.24 3.51 3.44 4.64 6.87 1.14 3.42 2.05 9.03 2.17 13.7C15.33 25.58 14.63 31.39 13.77 35.21 12.91 39.03 11.55 42.57 10.05 43.81 8.54 45.06 6.3 44.75 4.72 42.69 3.14 40.63 1.27 35.9.56 31.48-.14 27.06.0 20.7.48 16.16.96 11.63 2.03 6.85 3.42 4.24 4.8 1.63 7.85.99 8.8.49 9.76.0 9.17.92 9.14 1.25M7.74.52C9.47.1 11.68 2.21 13 4.88c1.31 2.67 2.42 7 2.63 11.67C15.84 21.22 15.11 28.52 14.26 32.89c-.85 4.36-2.24 8.06-3.72 9.83-1.49 1.78-3.62 2.22-5.21.82-1.6-1.4-3.38-5.4-4.36-9.21C-.01 30.51-.9 25.34-.57 20.65-.25 15.96 1.66 9.57 2.91 6.19 4.16 2.8 6.12 1.3 6.92.33 7.73-.63 7.77.08 7.75.42" stroke="#000" stroke-width="1" fill="none"/></g><g stroke-linecap="round"><g stroke-opacity=".9" fill-opacity=".9" transform="translate(394.77588547250286 308.04009652652667) rotate(0 14.659303301924297 -2.677051221420811)"><path d="M0 0C.68-.72 2.68-3.4 4.1-4.32c1.43-.92 2.54-.98 4.44-1.2C10.43-5.73 12.97-5.73 15.48-5.63c2.51.11 5.96.18 8.1.77 2.14.58 3.78 1.91 4.74 2.76C29.27-1.24 29.15-.12 29.32.27M0 0C.68-.72 2.68-3.4 4.1-4.32c1.43-.92 2.54-.98 4.44-1.2C10.43-5.73 12.97-5.73 15.48-5.63c2.51.11 5.96.18 8.1.77 2.14.58 3.78 1.91 4.74 2.76C29.27-1.24 29.15-.12 29.32.27" stroke="#000" stroke-width="1" fill="none"/></g></g><mask/><g transform="translate(308.5 350) rotate(0 100 10)"><text x="100" y="14.096" font-family="Excalifont, Xiaolai, Segoe UI Emoji" font-size="16" fill="#1e1e1e" text-anchor="middle" style="white-space:pre" direction="ltr" dominant-baseline="alphabetic">end user (web browser)</text></g><g stroke-linecap="round"><g transform="translate(236.5 132) rotate(0 56 48)"><path d="M.23-1.01C9.89 5.93 40.46 26.13 58.92 42.27c18.46 16.14 43.09 44.46 52.06 53.56M-1.1 1.07C8.83 8.1 41.99 27.42 61.07 43.42c19.07 16 43.55 45.09 52.27 53.64" stroke="#1e1e1e" stroke-width="2" fill="none"/></g><g transform="translate(236.5 132) rotate(0 56 48)"><path d="M24.35 5.59C13.47 1.34 4.77-1.07.23-1.01m24.12 6.6C18.41 3.55 10.57 1.16.23-1.01" stroke="#1e1e1e" stroke-width="2" fill="none"/></g><g transform="translate(236.5 132) rotate(0 56 48)"><path d="M14.46 19.55C7.26 9.97 2.32 2.27.23-1.01M14.46 19.55C11.26 13.45 6.25 7.06.23-1.01" stroke="#1e1e1e" stroke-width="2" fill="none"/></g></g><mask/></svg></div><figcaption><a class=image-link href=network_overview.svg><i class="fa fa-download"></i></a>
Network overview</figcaption></figure></p><p>The high-level steps of this setup process are:</p><ol><li>Create a self-hosted Docker-based Keycloak instance.</li><li>Configure an authentication realm, OIDC client and test users in Keycloak.</li><li>Configure the authentication provider in Velociraptor.</li><li>Add test users to Velociraptor.</li><li>Test the authentication process.</li></ol><h2 id=create-a-docker-based-keycloak-instance>Create a Docker-based Keycloak instance</h2><p>We assume that Docker has already been installed and configured on the
designated Keycloak host. We aren&rsquo;t going to use Docker Compose but for
production deployment you might prefer to do so, and example configurations can
be found on the internet.</p><p>Before we install Keycloak we are going to need a certificate for it to use. Here
we will generate a simple self-signed cert with corresponding private key but ideally in
production you would have a cert signed by a trusted CA.</p><p><strong>1. Generate a key pair</strong></p><pre><code class=language-sh># Create keycloak-server.crt.pem and keycloak-server.key.pem
openssl req -newkey rsa:2048 -nodes -subj &quot;/CN=keycloak.local&quot; \
-addext &quot;subjectAltName=DNS:keycloak.local,IP:192.168.56.1&quot; \
-keyout keycloak-server.key.pem -x509 -days 3650 -out keycloak-server.crt.pem
# Set appropriate permissions on files
chmod -R 644 keycloak-server*
</code></pre><p>NOTE: The certificate SAN is required by Velociraptor. If not present you will receive
this error when trying to start Velociraptor.<br><code>error: gui: starting frontend: Get "https://keycloak.local/.well-known/openid-configuration": x509: certificate relies on legacy Common Name field, use SANs instead</code><br>Putting the IP in the SAN is not really necessary but helpful if you need to
connect to Keycloak&rsquo;s admin page using it&rsquo;s IP.</p><p>Now that we have the key pair we can run Docker which will pull the latest
Keycloak image (26.0.7 at the time of writing).</p><p><strong>2. Run the Docker command.</strong></p><pre><code class=language-sh>docker run -p 443:443 -e KC_HOSTNAME=keycloak.local \
-e KC_BOOTSTRAP_ADMIN_USERNAME=admin -e KC_BOOTSTRAP_ADMIN_PASSWORD=admin \
-v /root/keycloak-server.crt.pem:/etc/x509/https/keycloak-server.crt.pem \
-v /root/keycloak-server.key.pem:/etc/x509/https/keycloak-server.key.pem \
-e KC_HTTPS_CERTIFICATE_FILE=/etc/x509/https/keycloak-server.crt.pem \
-e KC_HTTPS_CERTIFICATE_KEY_FILE=/etc/x509/https/keycloak-server.key.pem \
quay.io/keycloak/keycloak:latest start-dev --https-port=443
</code></pre><p>We set various Keycloak config options as Docker environment variables and
make the cert and private key available inside the Docker using volume mapping.</p><p>If the Docker fails to start, you should inspect the command output for errors.
If successful it should report
<code>Listening on: http://0.0.0.0:8080 and https://0.0.0.0:443</code>.</p><p>The KC_BOOTSTRAP* variables create an initial user <code>admin</code> with password
<code>admin</code> which we use to configure Keycloak in the next section.</p><h2 id=configure-keycloak>Configure Keycloak</h2><p>Next we go through the steps that are almost the same as described in Keycloak&rsquo;s
<a href=https://www.keycloak.org/getting-started/getting-started-docker target=_blank>Getting started guide</a>
.</p><p>Connect to Keycloak&rsquo;s Admin Console (in this case: <a href=https://keycloak.local target=_blank>https://keycloak.local</a>
) and
log in with the <code>admin</code> user.</p><p><strong>3. Create an authentication realm</strong></p><p><figure id=a95eb8c08fa648913b9893b649864bc1><div data-featherlight=#a95eb8c08fa648913b9893b649864bc1 class=figure><img src=keycloak00.png alt></div><figcaption><a class=image-link href=keycloak00.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>You can use any name for the realm but here we are going to just use <code>myrealm</code>
for convenience.</p><p><figure id=53dcd412a99f4cf293824a7b329e2c3f><div data-featherlight=#53dcd412a99f4cf293824a7b329e2c3f class=figure><img src=keycloak01.png alt></div><figcaption><a class=image-link href=keycloak01.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>Click <strong>Create</strong>.</p><p><strong>4. Create OIDC client configuration for Velociraptor</strong></p><p>In this step we create a new client record and client secret which we will use
later in the Velociraptor configuration. In the realm selection drop-down ensure
that you are in the new <code>myrealm</code> realm.</p><p>In the sidebar select <strong>Clients</strong> and then select <strong>Create client</strong>.</p><p><figure id=b765549e2d38410bcea9c79f931c3c84><div data-featherlight=#b765549e2d38410bcea9c79f931c3c84 class=figure><img src=keycloak02.png alt></div><figcaption><a class=image-link href=keycloak02.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>This will start a 3-page configuration wizard. On the first page the <strong>Client
ID</strong> is all that&rsquo;s required. Enter <code>velociraptor</code> and click <strong>Next</strong>.</p><p><figure id=79217a623d69f8f8d2136f7b6f875fc7><div data-featherlight=#79217a623d69f8f8d2136f7b6f875fc7 class=figure><img src=keycloak03.png alt></div><figcaption><a class=image-link href=keycloak03.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>On the second page, choose <strong>Client authentication: ON</strong> and
<strong>Authentication flow: Standard flow</strong> (only). Then click <strong>Next</strong>.</p><p><figure id=0f8adf194ac2d23ee44bde03f971a5b8><div data-featherlight=#0f8adf194ac2d23ee44bde03f971a5b8 class=figure><img src=keycloak04.png alt></div><figcaption><a class=image-link href=keycloak04.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>On the third page we use the following values (adapt to your DNS names if your
are replicating the setup in your own environment):</p><ul><li>Valid redirect URIs: <code>https://velociraptor.local:8889/auth/oidc/keycloak/callback</code></li><li>Valid post logout redirect URIs:
<code>https://velociraptor.local:8889/app/logoff.html</code></li><li>Web origins: <code>https://velociraptor.local</code></li></ul><p><figure id=680a948778124e0b21e6b194ef5b310a><div data-featherlight=#680a948778124e0b21e6b194ef5b310a class=figure><img src=keycloak05.png alt></div><figcaption><a class=image-link href=keycloak05.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>Then click <strong>Save</strong>. Your OIDC client configuration is now created.</p><p>On the page that follows, go to the <strong>Credentials</strong> tab. There you will find the
<strong>Client secret</strong> which you will need for your Velociraptor configuration. It is
randomly generated and you can regenerate it if desired, but if you do so then
don&rsquo;t forget to update your Velociraptor server&rsquo;s config with the new secret.
Typically you would only regenerate it if you suspected a compromised secret.</p><p><figure id=c028e0441ef62c53cd66ed4eb371c2bd><div data-featherlight=#c028e0441ef62c53cd66ed4eb371c2bd class=figure><img src=keycloak06.png alt></div><figcaption><a class=image-link href=keycloak06.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>The next action is to configure email addresses as login usernames. To do that
navigate via the sidebar to <strong>Realm settings</strong> > <strong>Login</strong> tab. Ensure that
<strong>Email as username</strong> and <strong>Login with email</strong> are enabled. The additional user
preferences shown in the following screenshot are optional and in your case
would be determined by your organizational policies.</p><p><figure id=688b70e233f7b149f02f81f39ecb073a><div data-featherlight=#688b70e233f7b149f02f81f39ecb073a class=figure><img src=keycloak08.png alt></div><figcaption><a class=image-link href=keycloak08.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>The last action in this step is to configure the required actions for
authentication so that users don&rsquo;t have to enter additional information when
they first log in.
Navigate via the sidebar to <strong>Authentication</strong> > <strong>Required actions</strong> tab.
Disable all options except <strong>Update password</strong>.</p><p><strong>5. Create test users</strong></p><p>We will need at least one user account to test the authentication. From the
sidebar select <strong>Users</strong> and then click the <strong>Create new user</strong> button.</p><p><figure id=f75abd5fd7309f3da9986f814ab200a5><div data-featherlight=#f75abd5fd7309f3da9986f814ab200a5 class=figure><img src=keycloak07.png alt></div><figcaption><a class=image-link href=keycloak07.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>For the user account I am going to create one named <code>bob@local</code>. Remember that
we previously enabled <strong>Email as username</strong> and <strong>Login with email</strong>, so all
other fields are optional. I also selected <strong>Email verified</strong> to avoid an email
verification step when logging in.</p><p><figure id=cb7b6a63eddd5ea217e2a8190ea68bd7><div data-featherlight=#cb7b6a63eddd5ea217e2a8190ea68bd7 class=figure><img src=keycloak09.png alt></div><figcaption><a class=image-link href=keycloak09.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>After creating the account, go to the Credentials tab and set a password. Note
that we leave <strong>Temporary:ON</strong> set so that the password must be changed on first
logon. Note also that this is a simplified demonstration so for that reason
we&rsquo;re ONLY using password auth while Keycloak easily supports multi-factor
authentication.</p><p><figure id=d0e5f2107f59ca1869103d86263ad441><div data-featherlight=#d0e5f2107f59ca1869103d86263ad441 class=figure><img src=keycloak10.png alt></div><figcaption><a class=image-link href=keycloak10.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>Repeat the user creation actions to also create a user account
<code>fred@local</code>.</p><p><figure id=2e597f774790a1692072c8401de23a6c><div data-featherlight=#2e597f774790a1692072c8401de23a6c class=figure><img src=keycloak11.png alt></div><figcaption><a class=image-link href=keycloak11.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>Now we are ready to move to configuring the Velociraptor side of things.</p><h2 id=configure-velociraptor>Configure Velociraptor</h2><div class="mynotices tip"><div heading=tip><p>While configuring, testing and potentially troubleshooting problems, it&rsquo;s
easier if you can see Velociraptor&rsquo;s log messages. You can stop the server
service and then run the server manually on the command line by using the
following commands:</p><pre><code class=language-bash>sudo systemctl stop velociraptor_server
sudo -u velociraptor bash
velociraptor -c /etc/velociraptor/server.config.yaml frontend -v
</code></pre><p>This will display the log messages in the terminal.</p></div></div><p><strong>6. Add the authenticator settings to your Velciraptor config</strong></p><p>In the <code>GUI</code> section of your Velociraptor config you should have the following
authenticator settings by default:</p><pre><code class=language-yaml>  authenticator:
    type: Basic
</code></pre><p>We no longer want Basic auth and instead want SSO, so replace that with these
new settings to match our Keycloak configuration:</p><pre><code class=language-yaml>    type: oidc
    oidc_issuer: https://keycloak.local/realms/myrealm
    oidc_name: keycloak
    avatar: https://www.keycloak.org/resources/images/logo.svg
    oauth_client_id: velociraptor
    oauth_client_secret: p4EABoniopnasbrmstDnsHrQcSukNmp2
</code></pre><p>The <code>oauth_client_secret</code> is the value we obtained at the end of step 4. The
<code>oauth_client_id</code> is the name we used for the OIDC Client ID in that same
section.</p><p>The <code>oidc_name</code> can be anything you want but it must exactly match
(case-sensitive) the substring used in the <strong>Valid redirect URIs</strong> field of the
client configuration in Keycloak.</p><p>Keycloak requires that the <code>oidc_issuer</code> field specify the path
<code>/realms/myrealm</code> as this is where is serves the OpenID Endpoint Configuration
that Velociraptor will need to access. If you have somehow gotten this wrong
then Velociraptor will log an error such as:
<code>[ERROR] can not get information from OIDC provider, check https://keycloak.local/.well-known/openid-configuration is correct and accessible from the server.</code></p><p>Before you start Velociraptor, if you are using a self-signed cert for Keycloak
then also attend to the next step.</p><p><strong>7. Copy the Keycloak server cert to the trusted root store.</strong></p><p>Because the Keycloak server is using a certificate that wasn&rsquo;t issued by a
trusted CA, we need to add it&rsquo;s certificate to the trusted root store on the
Velociraptor server. Assuming your server is Ubuntu or similar this means saving
a copy of the certificate to <code>/etc/ssl/certs</code>.</p><p>Without this step you will see this error in the log when attempting to start
Velociraptor:
<code>error: gui: starting frontend: Get "https://keycloak.local/...": x509: certificate signed by unknown authority (possibly because of "crypto/rsa: verification error" while trying to verify candidate authority certificate "keycloak.local")</code></p><p><strong>8. Start Velociraptor</strong></p><p>The server should now start cleanly and continue running. In the log messages
you should see <code>GUI will use the oidc authenticator</code>. That means everything is
OK with the authenticator config.</p><p>One possible gotcha is if the server&rsquo;s <code>GUI.public_url</code> setting is still using
an IP address or if <code>GUI.bind_address</code> is not set to <code>0.0.0.0</code> then you may get
stopped with the error:
<code>error: gui: starting frontend: Authentication type 'oidc' requires valid public_url parameter</code></p><p>In this case the <code>GUI.public_url</code> is set to <code>https://velociraptor.local:8889/</code>.</p><h2 id=add-test-users>Add test users</h2><p>We have created 2 users in Keycloak but these users don&rsquo;t yet exist in
Velociraptor. Velociraptor has it&rsquo;s own permissions model and therefore needs to
know about any users so that once they authenticate the correct permissions can
be applied.</p><p>Users can be created using VQL in Velociraptor notebooks but since we have now
switched authentication providers we no longer have access to the GUI. Of course
we could have added the users before we switched but let&rsquo;s pretend we didn&rsquo;t and
instead do it from the command line.</p><p>We will make <code>bob@local</code> a server admin and grant <code>fred@local</code> the &ldquo;reader&rdquo;
role, which provides minimal access to Velociraptor&rsquo;s GUI. The following two
commands will create these users:</p><p><strong>9. Add users to the datastore</strong></p><pre><code class=language-sh>velociraptor --config server.config.yaml user add --role administrator bob@local
velociraptor --config server.config.yaml user add --role reader fred@local
</code></pre><p>NOTE: We provide the <code>--config</code> flag so that this invocation of the velociraptor
binary knows which datastore to add the new users to. This can be done while the
server service is running or not running, but either way the service will need
to be restarted to update itself with the datastore changes.</p><p>Because of our OIDC authenticator config, when adding each user we will receive
an acknowledgement message saying
<code>"Authentication will occur via oidc - therefore no password needs to be set."</code></p><h2 id=test-authentication-process>Test authentication process</h2><p>Test the authentication process by going to <code>https://velociraptor.local:8889/</code></p><p>You will be presented with the choice to log in with Keycloak (multiple
authentication providers are supported but we only have one configured).</p><p><figure id=31e5adca94cd8097aa53d3d80b854494><div data-featherlight=#31e5adca94cd8097aa53d3d80b854494 class=figure><img src=auth00.png alt></div><figcaption><a class=image-link href=auth00.png><i class="fa fa-download"></i></a></figcaption></figure></p><p>Enter initial credentials (password that was set in Keycloak).</p><p><figure id=cdf9c2bc39d8b9246798ea0c93a41a77><div data-featherlight=#cdf9c2bc39d8b9246798ea0c93a41a77 class=figure><img src=auth01.png alt="Login page"></div><figcaption><a class=image-link href=auth01.png><i class="fa fa-download"></i></a>
Login page</figcaption></figure></p><p>You will be required to change the password because we configured
<strong>Temporary:ON</strong> when setting the account&rsquo;s password.</p><p><figure id=2aa22cd981916f37b088880464064e88><div data-featherlight=#2aa22cd981916f37b088880464064e88 class=figure><img src=auth02.png alt="Change the password"></div><figcaption><a class=image-link href=auth02.png><i class="fa fa-download"></i></a>
Change the password</figcaption></figure></p><p><figure id=8a64b7f7025e7880b3bf2e942eb4a6b9><div data-featherlight=#8a64b7f7025e7880b3bf2e942eb4a6b9 class=figure><img src=auth03.png alt="Successful login!"></div><figcaption><a class=image-link href=auth03.png><i class="fa fa-download"></i></a>
Successful login!</figcaption></figure></p><p><figure id=a8eb9d50ba9e3b752201affb797b7391><div data-featherlight=#a8eb9d50ba9e3b752201affb797b7391 class=figure><img src=auth04.png alt="We can verify that the user has the server admin role."></div><figcaption><a class=image-link href=auth04.png><i class="fa fa-download"></i></a>
We can verify that the user has the server admin role.</figcaption></figure></p><p><figure id=e6be4f3b4580ccf759ee6011572ac2d7><div data-featherlight=#e6be4f3b4580ccf759ee6011572ac2d7 class=figure><img src=auth05.png alt="We can sign out and sign in again."></div><figcaption><a class=image-link href=auth05.png><i class="fa fa-download"></i></a>
We can sign out and sign in again.</figcaption></figure></p><p>The same process applies to <code>fred@local</code> except that we can verify in
Velociraptor that the user has the read-only role.</p><div class="mynotices tip"><div heading=tip><p>For testing multiple users in the same web browser you may have trouble
fully logging a user out because while logged out of Velociraptor the OIDC
session is still active.</p><p>Logout of the OIDC session can be achieved by
navigating to the the endpoint
<code>https://keycloak.local/realms/myrealm/protocol/openid-connect/logout</code>
from within the same web browser and choosing to log out.</p></div></div><h2 id=what-next>What next?</h2><p>Once you have the working authentication setup, as per this guide, then you can
begin experimenting with additional options while knowing that any change which
causes a negative effect can be reverted back to a known working state. This is
a much easier approach than diving in with a complex configuration and spending
hours troubleshooting why it doesn&rsquo;t work.</p><p>Since the Docker installation used in the guide is non-permanent it will reset
when you restart the docker VM. For testing and experimenting that&rsquo;s a good
thing as you gain familiarity by going through the process. As mentioned,
Keycloak supports multifactor authentication, complex authentication flow
options, themeable login screens, and many other cool features. However for
permanent configuration you will need to learn how to create a persistent
Keycloak database, possibly using a different deployment method.</p><footer class=footline></footer></div></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1772163125></script><script src=/js/perfect-scrollbar.min.js?1772163125></script><script src=/js/perfect-scrollbar.jquery.min.js?1772163125></script><script src=/js/jquery.sticky.js?1772163125></script><script src=/js/featherlight.min.js?1772163125></script><script src=/js/highlight.min.js?1772163125></script><script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1772163125></script><script src=/js/learn.js?1772163125></script><script src=/js/hugo-learn.js?1772163125></script></body></html>