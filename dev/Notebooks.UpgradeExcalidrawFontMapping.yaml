name: Notebooks.UpgradeExcalidrawFontMapping
description: |
  Replaces Excalidraw's old standard font IDs with their new standard IDs in
  `.excalidraw` files.

  This is only needed if you want to open (in other words: import) old
  `.excalidraw` files in [excalidraw.com](excalidraw.com) and keep the fonts
  assigned to their "standard" Excalidraw UI font names.

  Excalidraw have changed their default fonts over time, even though their
  file format hasn't changed (it's currently "version 2"). In their file format
  they use assigned numeric IDs instead of font names and their code maps these
  to the actual fonts.

  | Excalidraw UI font name | CSS/SVG font family name (old) | Excalidraw fontFamily ID (old) | CSS/SVG font family name (new) | Excalidraw fontFamily ID (new) | Velociraptor WOFF2 font file name | What we use it for |
  |---|---|---|---|---|---|---|
  | Hand-drawn | Virgil | 1 | Excalifont | 5 | playpen-sans-v13-latin-500 | Default font |
  | Normal | Cascadia | 2 | Nunito | 6 | playpen-sans-v13-latin-800 | Heading font |
  | Code | Assistant | 3 | Comic Shanns | 8 | SVBasicManual | Code font |

  The old ID -> new ID mappings are defined in the variable `font_id_map` and a
  regex to see if files qualify for updating is defined in the `regex_check`
  variable. Update these if necessary.

  Normally you should not need to "upgrade" `.excalidraw` files in this way.
  But if they add new fonts in future with new fontFamily IDs, and assign them
  to their "standard" UI font names, then this may be needed to be allow opening
  and re-exporting old excalidraw files.

  ### Notes

  - This notebook works with local files and is intended to be run in "gui mode"
    on Linux.
  - **Will potentially do bad things if run on Windows!** So don't do that.

type: NOTEBOOK

parameters:
  - name: rel_path
    description: Path to the Excalidraw files relative to your $HOME directory
    default: projects/velociraptor-docs
    validating_regex: '^.+/.+$'
  - name: lookback_days
    type: int
    description: Only consider files modified <i>less</i> than this many days ago.
    default: 3

export: |
  LET regex_check <= '''("fontFamily": [123],)'''
  LET font_id_map <= dict(`"fontFamily": 1,` = '"fontFamily": 5,',
                          `"fontFamily": 2,` = '"fontFamily": 6,',
                          `"fontFamily": 3,` = '"fontFamily": 8,')
  LET since_date <= timestamp(epoch=now() - 86400 * lookback_days)
  LET files_path <= path_join(components=[expand(path="%HOME%"), rel_path], path_type="linux")
  LET file_candidates = SELECT OSPath, Mtime
                        FROM glob(root=files_path, globs="**/*.excalidraw")
                        WHERE Mtime > since_date
                        AND parse_string_with_regex(string=read_file(filename=OSPath),regex=regex_check)
  LET update_file(target_file) = regex_transform(source=read_file(filename=target_file), map=font_id_map, key="A")

sources:
  - notebook:
    - type: vql
      output: |
        <img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDgwIDgwIiB3aWR0aD0iNTAiIGhlaWdodD0iNTAiPgogIDxnIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAgMTApIHJvdGF0ZSgwIDMwIDMwKSI+PHBhdGggZD0iTTIwLjk4IDEuODYgQzI2LjczIC0wLjM0LCAzNS43OSAtMC42MiwgNDEuOCAxLjgzIEM0Ny44IDQuMjksIDU0IDEwLjYsIDU3LjAyIDE2LjYxIEM2MC4wNCAyMi42MSwgNjEuNDMgMzEuNzUsIDU5LjkxIDM3Ljg3IEM1OC40IDQzLjk5LCA1My4xMyA0OS43LCA0Ny45NCA1My4zMyBDNDIuNzUgNTYuOTUsIDM1LjIxIDU5Ljc0LCAyOC43NyA1OS42MyBDMjIuMzQgNTkuNTIsIDEzLjk3IDU3LjA1LCA5LjMyIDUyLjY1IEM0LjY4IDQ4LjI1LCAxLjY5IDM5LjY5LCAwLjkxIDMzLjI0IEMwLjEzIDI2Ljc4LCAwLjEgMTkuNDIsIDQuNjUgMTMuOTEgQzkuMiA4LjQsIDIyLjk4IDIuMjcsIDI4LjIyIDAuMTUgQzMzLjQ3IC0xLjk2LCAzNS45MSAwLjc4LCAzNi4xMiAxLjI0IE0yNi4xMyAwLjYxIEMzMi4zMiAtMC44NCwgNDMuMDQgMC4xMSwgNDguMzYgMy44MSBDNTMuNjcgNy41LCA1Ni41IDE2LjMsIDU4LjAzIDIyLjc3IEM1OS41NSAyOS4yNCwgNjAuMDcgMzYuOCwgNTcuNTIgNDIuNjQgQzU0Ljk2IDQ4LjQ3LCA0OC43MyA1NS4yOSwgNDIuNjggNTcuNzggQzM2LjYzIDYwLjI2LCAyNy42MSA1OS4zOCwgMjEuMjIgNTcuNTQgQzE0LjgyIDU1LjY5LCA3Ljg2IDUxLjc2LCA0LjI5IDQ2LjcgQzAuNzEgNDEuNjMsIC0xLjA3IDMzLjMyLCAtMC4yMiAyNy4xMiBDMC42MiAyMC45MiwgNC42NSAxNC4xNSwgOS4zNSA5LjQ5IEMxNC4wNiA0LjgzLCAyNS4wOCAwLjQ1LCAyOC4wMSAtMC44MiBDMzAuOTQgLTIuMDgsIDI2Ljc5IDEuMTIsIDI2LjkxIDEuOTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIwIiBmaWxsPSIjMjI4YmU2Ij48L3BhdGg+PHBhdGggZD0iTTI0LjE1IDAuNTYgQzMwLjExIC0xLjI0LCAzOC41IDAuMjQsIDQzLjkzIDMuMDUgQzQ5LjM3IDUuODcsIDU0LjQxIDExLjU5LCA1Ni43NyAxNy40NiBDNTkuMTQgMjMuMzMsIDU5Ljk1IDMyLjEzLCA1OC4xMyAzOC4yNyBDNTYuMzEgNDQuNDEsIDUxLjIyIDUwLjc0LCA0NS44NCA1NC4zMiBDNDAuNDYgNTcuOTEsIDMxLjk5IDYwLjQ2LCAyNS44NSA1OS43OCBDMTkuNzEgNTkuMTEsIDEzLjI4IDU0Ljg0LCA5LjAyIDUwLjI1IEM0Ljc1IDQ1LjY2LCAwLjc1IDM4LjY4LCAwLjIzIDMyLjI2IEMtMC4yOCAyNS44NSwgMC42MiAxNy4xOCwgNS45MyAxMS43NiBDMTEuMjQgNi4zNCwgMjYuNDkgMS4xOCwgMzIuMDggLTAuMjggQzM3LjY4IC0xLjc0LCAzOS40OCAyLjQzLCAzOS41IDIuOTkgTTMxLjA1IDAuNTEgQzM3LjM4IDAuNDQsIDQ1LjgxIDQuMzgsIDUwLjcyIDguNzEgQzU1LjYyIDEzLjAzLCA1OS45OCAyMC4xLCA2MC40OSAyNi40NiBDNjEuMDEgMzIuODEsIDU3LjQzIDQxLjU1LCA1My44MSA0Ni44NCBDNTAuMTkgNTIuMTIsIDQ0LjkzIDU2LjU0LCAzOC43NiA1OC4xNyBDMzIuNTkgNTkuODEsIDIyLjYxIDU5LjMsIDE2LjggNTYuNjQgQzEwLjk4IDUzLjk5LCA2LjcyIDQ3LjcyLCAzLjg4IDQyLjIzIEMxLjA1IDM2LjczLCAtMS42NiAyOS43NiwgLTAuMjQgMjMuNjYgQzEuMTggMTcuNTUsIDcuMTUgOS4zLCAxMi40MiA1LjYgQzE3LjY4IDEuOTEsIDI3Ljk0IDIuMzUsIDMxLjM1IDEuNDYgQzM0Ljc3IDAuNTgsIDMzLjA1IDAuMDMsIDMyLjkgMC4yOSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiPjwvcGF0aD48L2c+PGcgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNS43MTQyODU3MTQyODU3OCAxOC41NzE0Mjg1NzE0Mjg1NTUpIHJvdGF0ZSgwIDQuMjg1NzE0Mjg1NzE0Mjc4IDQuMjg1NzE0Mjg1NzE0Mjc4KSI+PHBhdGggZD0iTTQuMjEgLTAuMjMgQzUuMTIgLTAuMzIsIDYuMzMgMC4zMSwgNy4wOSAwLjk4IEM3Ljg1IDEuNjYsIDguNiAyLjk1LCA4Ljc2IDMuODEgQzguOTIgNC42NywgOC41MSA1LjQyLCA4LjA0IDYuMTUgQzcuNTggNi44OSwgNi44NCA3LjgsIDUuOTcgOC4yMSBDNS4xIDguNjIsIDMuNjggOC45MiwgMi44MyA4LjYyIEMxLjk3IDguMzIsIDEuMyA3LjIxLCAwLjgyIDYuMzkgQzAuMzQgNS41OCwgLTAuMTQgNC42LCAtMC4wNiAzLjcxIEMwLjAzIDIuODIsIDAuNiAxLjY3LCAxLjM0IDEuMDUgQzIuMDggMC40MywgMy44NSAwLjE3LCA0LjM5IDAuMDEgQzQuOTMgLTAuMTYsIDQuNiAtMC4wNCwgNC41OCAwLjA0IE01LjQyIC0wLjQ0IEM2LjMgLTAuMzQsIDYuNyAwLjk1LCA3LjIzIDEuNzQgQzcuNzcgMi41MiwgOC42IDMuMzcsIDguNjUgNC4yOCBDOC43IDUuMiwgOC4yIDYuNjEsIDcuNTQgNy4yMiBDNi44OCA3Ljg0LCA1LjY0IDcuOSwgNC42NyA4IEMzLjcxIDguMDksIDIuNTIgOC4xOSwgMS43NyA3Ljc5IEMxLjAyIDcuNCwgMC4zOSA2LjQzLCAwLjE3IDUuNjQgQy0wLjA0IDQuODUsIDAuMTEgMy45NSwgMC40OCAzLjA1IEMwLjg1IDIuMTYsIDEuNjQgMC43MiwgMi4zOCAwLjI5IEMzLjExIC0wLjE1LCA0LjM3IDAuNDMsIDQuODcgMC40NSBDNS4zNyAwLjQ3LCA1LjM5IDAuNDIsIDUuMzggMC40MSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjAiIGZpbGw9IiNmZmZmZmYiPjwvcGF0aD48cGF0aCBkPSJNNC40NiAtMC4wNyBDNS4yNCAtMC4xNCwgNi4xNyAwLjIsIDYuODEgMC43OCBDNy40NSAxLjM3LCA4LjE2IDIuNTQsIDguMzMgMy40NSBDOC40OSA0LjM1LCA4LjI2IDUuMzksIDcuNzkgNi4yMSBDNy4zMiA3LjAyLCA2LjMgOCwgNS41MiA4LjMzIEM0LjczIDguNjcsIDMuODkgOC41LCAzLjA3IDguMjEgQzIuMjYgNy45MiwgMS4xMSA3LjM5LCAwLjYxIDYuNTkgQzAuMSA1Ljc5LCAtMC4xNSA0LjM3LCAwLjA1IDMuNDEgQzAuMjQgMi40NSwgMS4wNCAxLjM4LCAxLjc3IDAuODYgQzIuNSAwLjM0LCAzLjkyIDAuNCwgNC40MiAwLjI4IEM0LjkyIDAuMTUsIDQuNzYgMC4xMywgNC43NyAwLjExIE00LjcxIDAuMTkgQzUuNjcgMC4xOCwgNi45OSAwLjU5LCA3LjU2IDEuMjQgQzguMTMgMS44OCwgOC4xIDMuMTUsIDguMTUgNC4wNCBDOC4xOSA0LjkzLCA4LjM4IDUuODgsIDcuODUgNi41NyBDNy4zMiA3LjI1LCA1LjgxIDcuOTQsIDQuOTUgOC4xMyBDNC4wOSA4LjMzLCAzLjUxIDguMDcsIDIuNjkgNy43NiBDMS44OCA3LjQ1LCAwLjQ1IDcuMDcsIDAuMDQgNi4yOCBDLTAuMzcgNS41LCAtMC4wMiAzLjksIDAuMjUgMy4wNSBDMC41MyAyLjIxLCAwLjkgMS43NiwgMS43IDEuMjMgQzIuNSAwLjcxLCA0LjYzIDAuMDksIDUuMDYgLTAuMSBDNS40OSAtMC4yOSwgNC4zMiAtMC4wNSwgNC4yOSAwLjEiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIj48L3BhdGg+PC9nPjxnIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzUuNzE0Mjg1NzE0Mjg1NzggMzUuNzE0Mjg1NzE0Mjg1NjY2KSByb3RhdGUoMCA0LjI4NTcxNDI4NTcxNDI3OCAxMi44NTcxNDI4NTcxNDI4NjEpIj48cGF0aCBkPSJNLTAuNTcgLTAuMjMgTDguNTcgLTAuNTUgTDkuMjEgMjUuNSBMLTAuNjggMjUuODYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIwIiBmaWxsPSIjZmZmZmZmIj48L3BhdGg+PHBhdGggZD0iTTAgMCBDMi41OCAtMC4xLCA0LjUxIC0wLjA5LCA4LjU3IDAgTTAgMCBDMS43NiAtMC4wOSwgMy41NSAtMC4wOSwgOC41NyAwIE04LjU3IDAgQzguODggOC4zNywgOC42IDE1LjIyLCA4LjU3IDI1LjcxIE04LjU3IDAgQzguOTQgOS42NSwgOC41NyAxOC40OSwgOC41NyAyNS43MSBNOC41NyAyNS43MSBDNi43OSAyNS43MiwgNC45IDI1Ljg5LCAwIDI1LjcxIE04LjU3IDI1LjcxIEM2LjA4IDI1LjY0LCAzLjM2IDI1LjYsIDAgMjUuNzEgTTAgMjUuNzEgQzAuNTEgMTYuOTgsIC0wLjEgNy41NiwgMCAwIE0wIDI1LjcxIEMtMC40OCAxNS41NywgMC4wOSA1Ljc5LCAwIDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIj48L3BhdGg+PC9nPjwvc3ZnPg==">
        1. Run this cell to see what files can be updated. <b>No changes will be made.</b><br><hr>
      template: |
        /*
        <img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDgwIDgwIiB3aWR0aD0iNTAiIGhlaWdodD0iNTAiPgogIDxnIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAgMTApIHJvdGF0ZSgwIDMwIDMwKSI+PHBhdGggZD0iTTIwLjk4IDEuODYgQzI2LjczIC0wLjM0LCAzNS43OSAtMC42MiwgNDEuOCAxLjgzIEM0Ny44IDQuMjksIDU0IDEwLjYsIDU3LjAyIDE2LjYxIEM2MC4wNCAyMi42MSwgNjEuNDMgMzEuNzUsIDU5LjkxIDM3Ljg3IEM1OC40IDQzLjk5LCA1My4xMyA0OS43LCA0Ny45NCA1My4zMyBDNDIuNzUgNTYuOTUsIDM1LjIxIDU5Ljc0LCAyOC43NyA1OS42MyBDMjIuMzQgNTkuNTIsIDEzLjk3IDU3LjA1LCA5LjMyIDUyLjY1IEM0LjY4IDQ4LjI1LCAxLjY5IDM5LjY5LCAwLjkxIDMzLjI0IEMwLjEzIDI2Ljc4LCAwLjEgMTkuNDIsIDQuNjUgMTMuOTEgQzkuMiA4LjQsIDIyLjk4IDIuMjcsIDI4LjIyIDAuMTUgQzMzLjQ3IC0xLjk2LCAzNS45MSAwLjc4LCAzNi4xMiAxLjI0IE0yNi4xMyAwLjYxIEMzMi4zMiAtMC44NCwgNDMuMDQgMC4xMSwgNDguMzYgMy44MSBDNTMuNjcgNy41LCA1Ni41IDE2LjMsIDU4LjAzIDIyLjc3IEM1OS41NSAyOS4yNCwgNjAuMDcgMzYuOCwgNTcuNTIgNDIuNjQgQzU0Ljk2IDQ4LjQ3LCA0OC43MyA1NS4yOSwgNDIuNjggNTcuNzggQzM2LjYzIDYwLjI2LCAyNy42MSA1OS4zOCwgMjEuMjIgNTcuNTQgQzE0LjgyIDU1LjY5LCA3Ljg2IDUxLjc2LCA0LjI5IDQ2LjcgQzAuNzEgNDEuNjMsIC0xLjA3IDMzLjMyLCAtMC4yMiAyNy4xMiBDMC42MiAyMC45MiwgNC42NSAxNC4xNSwgOS4zNSA5LjQ5IEMxNC4wNiA0LjgzLCAyNS4wOCAwLjQ1LCAyOC4wMSAtMC44MiBDMzAuOTQgLTIuMDgsIDI2Ljc5IDEuMTIsIDI2LjkxIDEuOTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIwIiBmaWxsPSIjMjI4YmU2Ij48L3BhdGg+PHBhdGggZD0iTTI0LjE1IDAuNTYgQzMwLjExIC0xLjI0LCAzOC41IDAuMjQsIDQzLjkzIDMuMDUgQzQ5LjM3IDUuODcsIDU0LjQxIDExLjU5LCA1Ni43NyAxNy40NiBDNTkuMTQgMjMuMzMsIDU5Ljk1IDMyLjEzLCA1OC4xMyAzOC4yNyBDNTYuMzEgNDQuNDEsIDUxLjIyIDUwLjc0LCA0NS44NCA1NC4zMiBDNDAuNDYgNTcuOTEsIDMxLjk5IDYwLjQ2LCAyNS44NSA1OS43OCBDMTkuNzEgNTkuMTEsIDEzLjI4IDU0Ljg0LCA5LjAyIDUwLjI1IEM0Ljc1IDQ1LjY2LCAwLjc1IDM4LjY4LCAwLjIzIDMyLjI2IEMtMC4yOCAyNS44NSwgMC42MiAxNy4xOCwgNS45MyAxMS43NiBDMTEuMjQgNi4zNCwgMjYuNDkgMS4xOCwgMzIuMDggLTAuMjggQzM3LjY4IC0xLjc0LCAzOS40OCAyLjQzLCAzOS41IDIuOTkgTTMxLjA1IDAuNTEgQzM3LjM4IDAuNDQsIDQ1LjgxIDQuMzgsIDUwLjcyIDguNzEgQzU1LjYyIDEzLjAzLCA1OS45OCAyMC4xLCA2MC40OSAyNi40NiBDNjEuMDEgMzIuODEsIDU3LjQzIDQxLjU1LCA1My44MSA0Ni44NCBDNTAuMTkgNTIuMTIsIDQ0LjkzIDU2LjU0LCAzOC43NiA1OC4xNyBDMzIuNTkgNTkuODEsIDIyLjYxIDU5LjMsIDE2LjggNTYuNjQgQzEwLjk4IDUzLjk5LCA2LjcyIDQ3LjcyLCAzLjg4IDQyLjIzIEMxLjA1IDM2LjczLCAtMS42NiAyOS43NiwgLTAuMjQgMjMuNjYgQzEuMTggMTcuNTUsIDcuMTUgOS4zLCAxMi40MiA1LjYgQzE3LjY4IDEuOTEsIDI3Ljk0IDIuMzUsIDMxLjM1IDEuNDYgQzM0Ljc3IDAuNTgsIDMzLjA1IDAuMDMsIDMyLjkgMC4yOSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiPjwvcGF0aD48L2c+PGcgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNS43MTQyODU3MTQyODU3OCAxOC41NzE0Mjg1NzE0Mjg1NTUpIHJvdGF0ZSgwIDQuMjg1NzE0Mjg1NzE0Mjc4IDQuMjg1NzE0Mjg1NzE0Mjc4KSI+PHBhdGggZD0iTTQuMjEgLTAuMjMgQzUuMTIgLTAuMzIsIDYuMzMgMC4zMSwgNy4wOSAwLjk4IEM3Ljg1IDEuNjYsIDguNiAyLjk1LCA4Ljc2IDMuODEgQzguOTIgNC42NywgOC41MSA1LjQyLCA4LjA0IDYuMTUgQzcuNTggNi44OSwgNi44NCA3LjgsIDUuOTcgOC4yMSBDNS4xIDguNjIsIDMuNjggOC45MiwgMi44MyA4LjYyIEMxLjk3IDguMzIsIDEuMyA3LjIxLCAwLjgyIDYuMzkgQzAuMzQgNS41OCwgLTAuMTQgNC42LCAtMC4wNiAzLjcxIEMwLjAzIDIuODIsIDAuNiAxLjY3LCAxLjM0IDEuMDUgQzIuMDggMC40MywgMy44NSAwLjE3LCA0LjM5IDAuMDEgQzQuOTMgLTAuMTYsIDQuNiAtMC4wNCwgNC41OCAwLjA0IE01LjQyIC0wLjQ0IEM2LjMgLTAuMzQsIDYuNyAwLjk1LCA3LjIzIDEuNzQgQzcuNzcgMi41MiwgOC42IDMuMzcsIDguNjUgNC4yOCBDOC43IDUuMiwgOC4yIDYuNjEsIDcuNTQgNy4yMiBDNi44OCA3Ljg0LCA1LjY0IDcuOSwgNC42NyA4IEMzLjcxIDguMDksIDIuNTIgOC4xOSwgMS43NyA3Ljc5IEMxLjAyIDcuNCwgMC4zOSA2LjQzLCAwLjE3IDUuNjQgQy0wLjA0IDQuODUsIDAuMTEgMy45NSwgMC40OCAzLjA1IEMwLjg1IDIuMTYsIDEuNjQgMC43MiwgMi4zOCAwLjI5IEMzLjExIC0wLjE1LCA0LjM3IDAuNDMsIDQuODcgMC40NSBDNS4zNyAwLjQ3LCA1LjM5IDAuNDIsIDUuMzggMC40MSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjAiIGZpbGw9IiNmZmZmZmYiPjwvcGF0aD48cGF0aCBkPSJNNC40NiAtMC4wNyBDNS4yNCAtMC4xNCwgNi4xNyAwLjIsIDYuODEgMC43OCBDNy40NSAxLjM3LCA4LjE2IDIuNTQsIDguMzMgMy40NSBDOC40OSA0LjM1LCA4LjI2IDUuMzksIDcuNzkgNi4yMSBDNy4zMiA3LjAyLCA2LjMgOCwgNS41MiA4LjMzIEM0LjczIDguNjcsIDMuODkgOC41LCAzLjA3IDguMjEgQzIuMjYgNy45MiwgMS4xMSA3LjM5LCAwLjYxIDYuNTkgQzAuMSA1Ljc5LCAtMC4xNSA0LjM3LCAwLjA1IDMuNDEgQzAuMjQgMi40NSwgMS4wNCAxLjM4LCAxLjc3IDAuODYgQzIuNSAwLjM0LCAzLjkyIDAuNCwgNC40MiAwLjI4IEM0LjkyIDAuMTUsIDQuNzYgMC4xMywgNC43NyAwLjExIE00LjcxIDAuMTkgQzUuNjcgMC4xOCwgNi45OSAwLjU5LCA3LjU2IDEuMjQgQzguMTMgMS44OCwgOC4xIDMuMTUsIDguMTUgNC4wNCBDOC4xOSA0LjkzLCA4LjM4IDUuODgsIDcuODUgNi41NyBDNy4zMiA3LjI1LCA1LjgxIDcuOTQsIDQuOTUgOC4xMyBDNC4wOSA4LjMzLCAzLjUxIDguMDcsIDIuNjkgNy43NiBDMS44OCA3LjQ1LCAwLjQ1IDcuMDcsIDAuMDQgNi4yOCBDLTAuMzcgNS41LCAtMC4wMiAzLjksIDAuMjUgMy4wNSBDMC41MyAyLjIxLCAwLjkgMS43NiwgMS43IDEuMjMgQzIuNSAwLjcxLCA0LjYzIDAuMDksIDUuMDYgLTAuMSBDNS40OSAtMC4yOSwgNC4zMiAtMC4wNSwgNC4yOSAwLjEiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIj48L3BhdGg+PC9nPjxnIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzUuNzE0Mjg1NzE0Mjg1NzggMzUuNzE0Mjg1NzE0Mjg1NjY2KSByb3RhdGUoMCA0LjI4NTcxNDI4NTcxNDI3OCAxMi44NTcxNDI4NTcxNDI4NjEpIj48cGF0aCBkPSJNLTAuNTcgLTAuMjMgTDguNTcgLTAuNTUgTDkuMjEgMjUuNSBMLTAuNjggMjUuODYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIwIiBmaWxsPSIjZmZmZmZmIj48L3BhdGg+PHBhdGggZD0iTTAgMCBDMi41OCAtMC4xLCA0LjUxIC0wLjA5LCA4LjU3IDAgTTAgMCBDMS43NiAtMC4wOSwgMy41NSAtMC4wOSwgOC41NyAwIE04LjU3IDAgQzguODggOC4zNywgOC42IDE1LjIyLCA4LjU3IDI1LjcxIE04LjU3IDAgQzguOTQgOS42NSwgOC41NyAxOC40OSwgOC41NyAyNS43MSBNOC41NyAyNS43MSBDNi43OSAyNS43MiwgNC45IDI1Ljg5LCAwIDI1LjcxIE04LjU3IDI1LjcxIEM2LjA4IDI1LjY0LCAzLjM2IDI1LjYsIDAgMjUuNzEgTTAgMjUuNzEgQzAuNTEgMTYuOTgsIC0wLjEgNy41NiwgMCAwIE0wIDI1LjcxIEMtMC40OCAxNS41NywgMC4wOSA1Ljc5LCAwIDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIj48L3BhdGg+PC9nPjwvc3ZnPg==">
        These files can be updated:
        */
        SELECT OSPath AS Path, Mtime AS `Last Modified` FROM file_candidates
    - type: vql
      output: |
        <img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDgwIDgwIiB3aWR0aD0iNTAiIGhlaWdodD0iNTAiPgogIDxnIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDQuOTMzMTg3MjY0NTc2NTMgMTApIHJvdGF0ZSgwIDAgMjkuMTEwOTg5Mzg3MTQ3MTMpIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0tMC4yNiAwLjkxIEwtMzYuNTcgNTYuMjMgTDMzLjI1IDU3LjMgTC0wLjQyIC0wLjY0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMCIgZmlsbD0iI2ZhYjAwNSIgZmlsbC1ydWxlPSJldmVub2RkIj48L3BhdGg+PHBhdGggZD0iTTAgMCBDLTEyLjM0IDE4Ljg3LCAtMjMuNyAzNC43NCwgLTM0LjkzIDU4LjIyIE0wIDAgQy0xMi4wOCAyMC43MSwgLTIyLjkzIDM5LjM4LCAtMzQuOTMgNTguMjIgTS0zNC45MyA1OC4yMiBDLTE3Ljk3IDU2LjgxLCAtNC4yNCA1Ny45NSwgMzQuOTMgNTguMjIgTS0zNC45MyA1OC4yMiBDLTE4LjQ2IDU4LjUyLCAtMC42OSA1OS4xMiwgMzQuOTMgNTguMjIgTTM0LjkzIDU4LjIyIEMyMi44MiAzNS4wOCwgOC4xOSAxNS4zMSwgMCAwIE0zNC45MyA1OC4yMiBDMjIuNSAzNS44NiwgOS4xMiAxNC44NywgMCAwIE0wIDAgQzAgMCwgMCAwLCAwIDAgTTAgMCBDMCAwLCAwIDAsIDAgMCIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiPjwvcGF0aD48L2c+PC9nPjxtYXNrPjwvbWFzaz48ZyBzdHJva2UtbGluZWNhcD0icm91bmQiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ1LjIyODY1Mzg5MTczMDggNDcuNjQ5MjU0NDgxMzQ0ODgpIHJvdGF0ZSgwIDAgLTExLjM5NTYwMjU5NzMzNTM5NykiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTS0wLjgyIC0xIEwtNi4zOCAtMjMuMjUgTDUuMzMgLTIzLjExIEwwLjQ4IDAuMzciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIwIiBmaWxsPSIjZmZmZiIgZmlsbC1ydWxlPSJldmVub2RkIj48L3BhdGg+PHBhdGggZD0iTTAgMCBDLTEuOTIgLTUuNTgsIC0xLjkgLTkuNTYsIC01LjU0IC0yMi43OSBNMCAwIEMtMS4xMyAtNi40NiwgLTMuNDUgLTEyLjcyLCAtNS41NCAtMjIuNzkgTS01LjU0IC0yMi43OSBDLTEuOTIgLTIyLjc2LCAxLjY1IC0yMi40MSwgNS41NCAtMjIuNzkgTS01LjU0IC0yMi43OSBDLTIuNDcgLTIyLjU5LCAwLjg2IC0yMi43NiwgNS41NCAtMjIuNzkgTTUuNTQgLTIyLjc5IEM0LjQyIC0xNi45MSwgMy45MiAtMTIuOTcsIDAgMCBNNS41NCAtMjIuNzkgQzQuMiAtMTYuNzQsIDIuNjggLTEwLjUyLCAwIDAgTTAgMCBDMCAwLCAwIDAsIDAgMCBNMCAwIEMwIDAsIDAgMCwgMCAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSI+PC9wYXRoPjwvZz48L2c+PG1hc2s+PC9tYXNrPjxnIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzkuMTEwOTg5Mzg3MTQ3MTMgNTMuMDg0MjY0MjkyOTc3NzY0KSByb3RhdGUoMCA1LjgyMjE5Nzg3NzQyOTQwMyA1LjgyMjE5Nzg3NzQyOTQwMykiPjxwYXRoIGQ9Ik02LjIgLTAuMDcgQzcuNDIgMC4wMiwgOS41MSAxLjM1LCAxMC40NiAyLjI2IEMxMS40MSAzLjE3LCAxMS45MSA0LjE2LCAxMS45MSA1LjQgQzExLjkgNi42MywgMTEuMTUgOC42NCwgMTAuNDMgOS42NSBDOS43MiAxMC42NywgOC44MiAxMS4xNiwgNy42MiAxMS40NiBDNi40MiAxMS43NywgNC40NiAxMi4wMSwgMy4yMyAxMS40OSBDMiAxMC45NywgMC42NiA5LjYzLCAwLjI0IDguMzQgQy0wLjE4IDcuMDUsIDAuMjUgNC45NCwgMC43IDMuNzMgQzEuMTUgMi41MywgMS45OCAxLjcyLCAyLjkyIDEuMDkgQzMuODYgMC40NiwgNS43IDAuMTcsIDYuMzIgLTAuMDQgQzYuOTMgLTAuMjYsIDYuNjEgLTAuMzEsIDYuNiAtMC4yMiBNMy43NSAtMC4zOCBDNS4wMiAtMC42NiwgNy41OCAwLjU3LCA4LjgzIDEuMTQgQzEwLjA3IDEuNzEsIDEwLjc3IDEuOSwgMTEuMjIgMy4wNCBDMTEuNjYgNC4xOSwgMTEuODUgNi43NSwgMTEuNTIgNy45OSBDMTEuMTggOS4yMywgMTAuMzYgMTAsIDkuMiAxMC41IEM4LjAzIDEwLjk5LCA1LjgyIDExLjA1LCA0LjUxIDEwLjk2IEMzLjIgMTAuODYsIDIuMjIgMTAuNjgsIDEuMzUgOS45NCBDMC40NyA5LjIxLCAtMC42MSA3Ljg1LCAtMC43NCA2LjU0IEMtMC44NyA1LjIzLCAtMC4yOCAzLjEsIDAuNTcgMi4wOSBDMS40MyAxLjA4LCAzLjY4IDAuNzMsIDQuMzggMC40OCBDNS4wOSAwLjI0LCA0LjY4IDAuNjEsIDQuOCAwLjYxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMCIgZmlsbD0iI2ZmZmYiPjwvcGF0aD48cGF0aCBkPSJNNi41OSAwLjM5IEM3Ljc3IDAuMzQsIDguODMgMC4zNSwgOS42NiAxLjE3IEMxMC41IDEuOTksIDExLjM2IDQuMDQsIDExLjU5IDUuMjkgQzExLjgyIDYuNTUsIDExLjc1IDcuNjgsIDExLjA2IDguNyBDMTAuMzYgOS43MSwgOC43MiAxMC45MiwgNy40MiAxMS4zOSBDNi4xMyAxMS44NSwgNC40MyAxMi4wNSwgMy4yOSAxMS41MSBDMi4xNCAxMC45NiwgMS4wNCA5LjMxLCAwLjUzIDguMTQgQzAuMDIgNi45NywgLTAuMTQgNS41OSwgMC4yMiA0LjUgQzAuNTggMy40MSwgMS42NiAyLjQsIDIuNjkgMS41OSBDMy43MSAwLjc4LCA1LjY5IC0wLjEyLCA2LjM5IC0wLjM5IEM3LjA4IC0wLjY1LCA2Ljg1IC0wLjI0LCA2Ljg0IDAgTTcuMjUgLTAuMzMgQzguNDYgLTAuMTMsIDkuNjcgMS4xLCAxMC40IDIuMiBDMTEuMTQgMy4yOSwgMTEuNyA1LjA0LCAxMS42NiA2LjI1IEMxMS42MiA3LjQ2LCAxMC45MyA4LjQ0LCAxMC4xNiA5LjQ1IEM5LjM4IDEwLjQ2LCA4LjMxIDEyLjAyLCA3LjAxIDEyLjI5IEM1LjcxIDEyLjU2LCAzLjM2IDExLjk2LCAyLjM2IDExLjA5IEMxLjM2IDEwLjIxLCAxLjQxIDguMTksIDEgNy4wMyBDMC42IDUuODgsIC0wLjQzIDUuMiwgLTAuMDggNC4xNyBDMC4yNiAzLjE0LCAxLjkyIDEuNDYsIDMuMDYgMC44NCBDNC4yIDAuMjIsIDYuMjQgMC42NiwgNi43NyAwLjQzIEM3LjMgMC4yLCA2LjM0IC0wLjUyLCA2LjIzIC0wLjU0IiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSI+PC9wYXRoPjwvZz48L3N2Zz4=">
        2. Edit the notebook parameters if needed before running this cell.<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
        &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<b>Running this cell may change files on disk</b> - be careful!<br><hr>
      template: |
        /*
        <img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDgwIDgwIiB3aWR0aD0iNTAiIGhlaWdodD0iNTAiPgogIDxnIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAgMTApIHJvdGF0ZSgwIDMwIDMwKSI+PHBhdGggZD0iTTM4LjU3IDAuNjUgQzQ0LjQgMi4yNywgNTEuODYgOC43LCA1NS4yMSAxNC40IEM1OC41NiAyMC4xLCA1OS43IDI4LjU3LCA1OC42OSAzNC44NCBDNTcuNjkgNDEuMTIsIDUzLjg0IDQ3LjgsIDQ5LjE5IDUyLjA3IEM0NC41MyA1Ni4zMywgMzYuOTkgNjAuMSwgMzAuNzYgNjAuNDMgQzI0LjUzIDYwLjc1LCAxNi43MSA1OC4xMiwgMTEuOCA1NC4wMiBDNi44OCA0OS45MSwgMi43NCA0Mi4xOSwgMS4yOSAzNS44MSBDLTAuMTcgMjkuNDQsIDAuMjkgMjEuMzMsIDMuMDggMTUuNzkgQzUuODcgMTAuMjQsIDExLjQ4IDQuNTYsIDE4LjAzIDIuNTcgQzI0LjU4IDAuNTcsIDM3Ljg0IDMuNCwgNDIuMzcgMy44IEM0Ni44OSA0LjE5LCA0NS4yMiA0Ljc0LCA0NS4yIDQuOTQgTTI3LjIyIC0xLjIzIEMzMi43OSAtMi4wMywgNDAuMDYgMi4xNiwgNDUuMDUgNS45NyBDNTAuMDQgOS43NywgNTUuMTEgMTUuODcsIDU3LjE3IDIxLjU4IEM1OS4yMyAyNy4yOSwgNTkuNTggMzQuNjIsIDU3LjQxIDQwLjIzIEM1NS4yMyA0NS44NSwgNDkuOTkgNTIuMzEsIDQ0LjExIDU1LjI1IEMzOC4yNCA1OC4xOSwgMjguNjYgNTkuMTksIDIyLjE3IDU3Ljg3IEMxNS42OSA1Ni41NSwgOC42OCA1Mi4xMiwgNS4yMyA0Ny4zMyBDMS43NyA0Mi41NCwgMC44MSAzNS4yOCwgMS40NCAyOS4xMiBDMi4wOCAyMi45NywgNC45MSAxNS4zNSwgOS4wMSAxMC4zNyBDMTMuMTEgNS40LCAyMy4yNyAwLjg3LCAyNi4wNCAtMC43NSBDMjguODEgLTIuMzcsIDI1LjUyIDAuMjQsIDI1LjY0IDAuNjYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIwIiBmaWxsPSIjMTJiODg2Ij48L3BhdGg+PHBhdGggZD0iTTI2LjQ3IDAuNDUgQzMyLjYyIC0wLjgzLCA0Mi42MSAwLjYzLCA0Ny45MSA0LjMgQzUzLjIyIDcuOTgsIDU2Ljc0IDE2LjE0LCA1OC4zMiAyMi41MiBDNTkuOTEgMjguOSwgNjAuMDMgMzYuNzUsIDU3LjQ0IDQyLjU5IEM1NC44NCA0OC40MiwgNDguNzEgNTQuOTcsIDQyLjc0IDU3LjU1IEMzNi43OCA2MC4xMiwgMjcuOTcgNTkuODEsIDIxLjYzIDU4LjA0IEMxNS4yOSA1Ni4yNywgOC4zMyA1Mi4wNSwgNC43MSA0Ni45MyBDMS4wOCA0MS44LCAtMC44NSAzMy41NSwgLTAuMTIgMjcuMjggQzAuNjIgMjEuMDEsIDMuNzMgMTMuOTUsIDkuMTEgOS4zMSBDMTQuNSA0LjY2LCAyNy43NyAwLjYzLCAzMi4yMSAtMC41OSBDMzYuNjQgLTEuODEsIDM1LjczIDEuMywgMzUuNzUgMS45OSBNMjguMjYgMC4wOCBDMzQuMzQgLTAuODcsIDQxLjg5IDIuODIsIDQ2Ljg3IDYuNTQgQzUxLjg1IDEwLjI2LCA1Ni4xNiAxNi42NywgNTguMTQgMjIuNDEgQzYwLjEyIDI4LjE1LCA2MS4xMiAzNS4xNiwgNTguNzYgNDAuOTkgQzU2LjQxIDQ2LjgyLCA1MC4yIDU0LjQzLCA0NC4wMSA1Ny4zOSBDMzcuODIgNjAuMzYsIDI4LjEzIDYwLjYyLCAyMS42MiA1OC43OCBDMTUuMTIgNTYuOTQsIDguNzggNTEuNTYsIDQuOTkgNDYuMzYgQzEuMiA0MS4xNiwgLTEuNDUgMzMuOSwgLTEuMTEgMjcuNTcgQy0wLjc3IDIxLjI1LCAyLjM0IDEzLjIsIDcuMDQgOC4zOCBDMTEuNzQgMy41NywgMjMuOTUgLTAuMTksIDI3LjA4IC0xLjMzIEMzMC4yMiAtMi40OCwgMjUuNjYgMC43NSwgMjUuODUgMS41MSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiPjwvcGF0aD48L2c+PGcgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNi45NTU5ODI1MjcxNDM3NiAyNy42NTY3OTk5NTYxNTE4NzIpIHJvdGF0ZSgyOTkuNDEwOTk3MjM4MjQyMyA0LjQ4MjU5OTY2MjU0NDMxNyAxMC4wMzM4NjI3NTUwMjg5MzUpIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0tMC43OSAtMC45MiBMLTAuNTggOS40OSBMMTguODcgMTAuNDMgTDE4LjYxIDIwLjU3IEwtOS4xIDE5LjQxIEwtOS40MiAtMC4xMiBMMC4xIC0wLjk4IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMCIgZmlsbD0iI2ZmZmZmZiIgZmlsbC1ydWxlPSJldmVub2RkIj48L3BhdGg+PHBhdGggZD0iTTAgMCBDMC4xNCA0LjAyLCAtMC4zNiA3LjIzLCAwIDEwLjAzIE0wIDAgQzAuMDcgMy45NCwgLTAuMDIgNy43NiwgMCAxMC4wMyBNMCAxMC4wMyBDNS40NCA5LjcxLCAxMi4xOSA5Ljg0LCAxNy45MyAxMC4wMyBNMCAxMC4wMyBDNS45NSA5Ljg5LCAxMi44MiAxMC4zNiwgMTcuOTMgMTAuMDMgTTE3LjkzIDEwLjAzIEMxOC4yNiAxNC4wNiwgMTcuODkgMTcuMTgsIDE3LjkzIDIwLjA3IE0xNy45MyAxMC4wMyBDMTguMTMgMTMuNzksIDE4LjA1IDE4LjAyLCAxNy45MyAyMC4wNyBNMTcuOTMgMjAuMDcgQzExLjAzIDE5LjIxLCA1LjYxIDE5LjA5LCAtOC45NyAyMC4wNyBNMTcuOTMgMjAuMDcgQzEwLjkxIDIwLjE4LCA0Ljk0IDE5Ljk2LCAtOC45NyAyMC4wNyBNLTguOTcgMjAuMDcgQy04LjcyIDE1LjEsIC05LjggOS44LCAtOC45NyAwIE0tOC45NyAyMC4wNyBDLTguNzEgMTQuMjYsIC05LjE0IDkuMTYsIC04Ljk3IDAgTS04Ljk3IDAgQy01LjU4IC0wLjE1LCAtMy4wMSAtMC4wMywgMCAwIE0tOC45NyAwIEMtNi44MiAtMC4wNCwgLTUuMTIgMC4yLCAwIDAgTTAgMCBDMCAwLCAwIDAsIDAgMCBNMCAwIEMwIDAsIDAgMCwgMCAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSI+PC9wYXRoPjwvZz48L2c+PG1hc2s+PC9tYXNrPjwvc3ZnPg==">
        These files were updated:
        */
        SELECT copy(filename=update_file(target_file=OSPath), accessor="data", dest=OSPath) AS Path,
               timestamp(epoch=now()) AS Modified
        FROM file_candidates
