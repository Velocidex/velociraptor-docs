name: Windows.Registry.PrintNightmare
author: Daksh Gajjar
description: Looks for the registry values to find a registry key named “NoWarningNoElevationOnInstall”.
type: CLIENT
precondition: SELECT OS From info() where OS = 'windows'
parameters:
  - name: SearchRegistryGlob
    description: Registry path
    default: \HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\**
sources:
  - query: |
    SELECT  Name as KeyName,
      FullPath,
      Data.type as KeyType, 
      Data.value as KeyValue,
      Sys,
      ModTime as Modified
    FROM glob(globs=SearchRegistryGlob, accessor='registry')
    WHERE KeyType = "DWORD"
      AND KeyName =~ "NoWarningNoElevationOnInstall"                
column_types:
  - name: Modified
    type: timestamp
