<p><span>Published by <b>rapid7</b></span> Published 2023-04-21
  (updated 2023-04-21)</p>
<details class="popup">
  <summary class="lbl rnd sec CVSS LOW">CVSS · LOW ·
    3.3<sub>⁄10</sub> <span style="font-size:0px;opacity:0">·
      CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L</span></summary>
  <div class="pop wht rnd shd pad bor"><span>Scoring scenario:</span>
    GENERAL
    <div>attackVector: <b>LOCAL</b></div>
    <div>attackComplexity: <b>LOW</b></div>
    <div>privilegesRequired: <b>NONE</b></div>
    <div>userInteraction: <b>REQUIRED</b></div>
    <div>scope: <b>UNCHANGED</b></div>
    <div>confidentialityImpact: <b>NONE</b></div>
    <div>integrityImpact: <b>NONE</b></div>
    <div>availabilityImpact: <b>LOW</b></div>
    <div><a class="vgi-dial" href=
            "https://cvss.js.org/#CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L"
            target="_blank">Open CVSS Calc</a></div>
  </div>
</details>
<div id="description">
  <p>Due to insufficient validation in the PE and OLE parsers in
    Rapid7's Velociraptor versions earlier than 0.6.8 allows attacker
    to crash Velociraptor during parsing of maliciously malformed
    files.&nbsp;<br>
    <br>
    For this attack to succeed, the attacker needs to be able to
    introduce malicious files to the system at the same time that
    Velociraptor attempts to collect any artifacts that attempt to
    parse PE files, Authenticode signatures, or OLE files. After
    crashing, the Velociraptor service will restart and it will still
    be possible to collect other artifacts.<br>
    <br></p>
</div>
<div id="problem">
  <h4 class="vgi-bug">Problem:</h4>
  <p>CWE-125 Out-of-bounds Read <a href=
                                   "https://cwe.mitre.org/data/definitions/CWE-125" target=
                                   "_blank"><small>CWE-125</small></a><br></p>
</div>
<div id="impact">
  <h4 class="vgi-impact">Impact:</h4>
  <p>CAPEC-540 Overread Buffers <a href=
                                   "https://capec.mitre.org/data/definitions/CAPEC-540" target=
                                   "_blank"><small>CAPEC-540</small></a><br></p>
</div>
<div id="status">
  <h4>Affected Product Status:</h4>
  <table class="tbl gap">
    <colgroup>
      <col>
      <col class="affectedCol"></colgroup>
    <thead>
      <tr>
        <th>Product</th>
        <th>Affected</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td rowspan="1"><b class="vgi-package">Rapid7 Velociraptor</b>
          <span>» PE Parser, OLE parser, Authenticode parser</span> <i>on</i>
          <span class="vgi-stack">Windows</span><br>
          <a class="vgi-package" href=
             "https://github.com/Velocidex/velociraptor/releases">package
            repo</a><a class="vgi-ext" href=
                       "https://github.com/Velocidex/velociraptor/">source repo</a><br>
          <span class="vgi-impact">Default status is unaffected</span></td>
        <td>before 0.6.8<br></td>
      </tr>
    </tbody>
  </table>
  <br style="font-size:0;"></div>
<div id="solution">
  <h4 class="vgi-safe">Solution:</h4>
  <p>Upgrade the clients to version 0.6.8-2</p>
</div>
<div class="rnd pad sec vgap" id="credits">
  <h4 class="vgi-like">Credits:</h4>
  <p>Thanks to b1tg https://github.com/b1tg for reporting these
    issues and providing samples that trigger the crashes</p>
</div>
