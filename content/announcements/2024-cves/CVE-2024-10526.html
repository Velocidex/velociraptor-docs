<div class="cve">

  <span>Published</span>on 2024-11-03</p><p></p><div id="description"><b class="tag rnd CVSS MEDIUM">x_open-source</b>   <p>The Velociraptor Windows MSI installer creates the installation directory with WRITE_DACL permission to the BUILTIN\Users group. This allows local users who are not administrators to grant themselves the Full Control permission on Velociraptor's files. By modifying Velociraptor's files, local users can subvert the binary and cause the Velociraptor service to execute arbitrary code as the SYSTEM user, or to replace the Velociraptor binary completely.<br></p></div><div id="problem"><h2>Problem: </h2><p>CWE-552 Files or Directories Accessible to External Parties  <a href="https://cwe.mitre.org/data/definitions/552" target="_blank"><small>CWE-552</small></a><br>CWE-732 Incorrect Permission Assignment for Critical Resource  <a href="https://cwe.mitre.org/data/definitions/732" target="_blank"><small>CWE-732</small></a><br></p></div><div id="impact"><h2>Impact:  </h2><p>CAPEC-165 File Manipulation  <a href="https://capec.mitre.org/data/definitions/165" target="_blank"><small>CAPEC-165</small></a><br>CAPEC-233 Privilege Escalation  <a href="https://capec.mitre.org/data/definitions/233" target="_blank"><small>CAPEC-233</small></a><br></p></div><div id="status"><h2>Product Status:</h2><table class="striped"><colgroup><col><col class="affectedCol"></colgroup><thead><tr><th>Product</th><th>Affected</th></tr></thead><tbody><tr><td rowspan="1"><b class="vgi-package">Rapid7 Velociraptor</b><span> Â» MSI Installer</span><i> on </i> <span class="vgi-stack">Windows</span><br><a class="vgi-ext" href="https://github.com/Velocidex/velociraptor">source repo</a><span class="vgi-text">
            <a href="https://github.com/Velocidex/velociraptor/blob/master/docs/wix/velociraptor_amd64.xml">
              https://github.com/Velocidex/velociraptor/blob/master/docs/wix/velociraptor_amd64.xml
            </a>

          </span><br><span class="vgi-impact">Default status is unaffected</span></td><td> before 0.73.3 (unaffected from 0.73.3)<br></td></tr></tbody></table><br style="font-size:0;"></div><div id="solution"><h2>Solution:</h2><p>For new installs use the updated MSI. If you do not wish to upgrade the endpoint client at this time, please arrange to run the icacls.exe command sequence described below at the earliest time.</p></div><div id="workaround"><h2>Workaround:</h2><p>In the Velociraptor start a hunt over all your Windows Assets, select the&nbsp;Windows.System.PowerShell artifact and paste the following in the&nbsp;Command parameter:<br><br>

<pre><code class="language-bash">
    icacls.exe "c:\Program Files\Velociraptor" /inheritance:d /t /c
    icacls.exe "c:\Program Files\Velociraptor" /remove builtin\users /t /c
</code></pre>

    <br><br><br>This hunt will update the ACLs on the Velociraptor directory to remove all BUILTIN\Users permissions.</p></div><div class="rnd pad sec vgap" id="credits"><h2>Credits:</h2><p>We thank Jean-Baptiste Mesnard-Sense from SYNACKTIV for identifying and reporting this issue</p></div><div id="timeline"><h2>Timeline:</h2><p></p><ul><li>2024-10-28 - Initial Notification by SYNACKTIV</li><li>2024-11-03 - 0.73.3 was released to address this issue and an advisory published on Velociraptor's website.</li></ul><p></p></div><div id="references"><h2>References</h2><p></p><div><a href="https://docs.velociraptor.app/announcements/2024-cves/">docs.velociraptor.app/announcements/2024-cves/</a></div><p></p></div></div>

</div>
