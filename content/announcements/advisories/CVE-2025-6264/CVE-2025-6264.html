<div class="cve">
  <p>
    <span>Published
    </span>on 2025-06-19
  </p>
  <p>
  </p>
  <details class="popup">
    <summary class="lbl rnd sec CVSS MEDIUM">CVSS · MEDIUM · 4.7
      <sub>⁄10
      </sub>
      <span style="font-size:0px;opacity:0"> · CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:L
      </span>
    </summary>
    <div class="pop wht rnd shd pad bor">
      <span>Scoring scenario:
      </span>GENERAL
      <div>attackVector:
        <b>LOCAL
        </b>
      </div>
      <div>attackComplexity:
        <b>HIGH
        </b>
      </div>
      <div>privilegesRequired:
        <b>HIGH
        </b>
      </div>
      <div>userInteraction:
        <b>REQUIRED
        </b>
      </div>
      <div>scope:
        <b>CHANGED
        </b>
      </div>
      <div>confidentialityImpact:
        <b>LOW
        </b>
      </div>
      <div>integrityImpact:
        <b>LOW
        </b>
      </div>
      <div>availabilityImpact:
        <b>LOW
        </b>
      </div>
      <div>
        <a class="vgi-dial" href="https://cvss.js.org/#CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:L" target="_blank">Open CVSS Calc
        </a>
      </div>
    </div>
  </details>
  <p>
  </p>
  <div id="description">
    <p>Velociraptor allows collection of VQL queries packaged into Artifacts from endpoints. These artifacts can be used to do anything and usually run with elevated permissions.&nbsp; To limit access to some dangerous artifact, Velociraptor allows for those to require high permissions like EXECVE to launch.
      <br>
      <br>The Admin.Client.UpdateClientConfig is an artifact used to update the client's configuration. This artifact did not enforce an additional required permission, allowing users with COLLECT_CLIENT permissions (normally given by the "Investigator" role) to collect it from endpoints and update the configuration.
      <br>
      <br>This can lead to arbitrary command execution and endpoint takeover.
      <br>
      <br>To successfully exploit this vulnerability the user must already have access to collect artifacts from the endpoint (i.e. have the COLLECT_CLIENT given typically by the "Investigator' role).&nbsp;
    </p>
  </div>
  <div id="configs">
    <h2>Required configuration for exposure:
    </h2>
    <p>Users who rely on artifacts to prevent dangerous actions from already privileged users.
    </p>
  </div>
  <div id="problem">
    <h2>Problem:
    </h2>
    <p>CWE-276 Incorrect Default Permissions
      <a href="https://cwe.mitre.org/data/definitions/276" target="_blank">
        <small>CWE-276
        </small>
      </a>
      <br>
    </p>
  </div>
  <div id="impact">
    <h2>Impact:
    </h2>
    <p>CAPEC-30 Hijacking a Privileged Thread of Execution
      <a href="https://capec.mitre.org/data/definitions/30" target="_blank">
        <small>CAPEC-30
        </small>
      </a>
      <br>
    </p>
  </div>
  <div id="status">
    <h2>Product Status:
    </h2>
    <table class="striped">
      <colgroup>
        <col>
        <col class="affectedCol">
      </colgroup>
      <thead>
        <tr>
          <th>Product
          </th>
          <th>Affected
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td rowspan="1">
            <b class="vgi-package">Rapid7 Velociraptor
            </b>
            <i> on
            </i>
            <span class="vgi-stack">Windows, MacOS, Linux
            </span>
            <br>
            <a class="vgi-ext" href="https://github.com/Velocidex/velociraptor">source repo
            </a>
            <br>
            <span class="vgi-impact">Default status is unaffected
            </span>
          </td>
          <td> before 0.74.3
            <br>
          </td>
        </tr>
      </tbody>
    </table>
    <br style="font-size:0;">
  </div>
  <div id="workaround">
    <h2>Workaround:
    </h2>
    <p>To better restrict the types of artifacts users can run, the `basic artifacts` mechanism should be used as described&nbsp;
      <a target="_blank" rel="nofollow" href="https://docs.velociraptor.app/docs/artifacts/security/#basic-artifacts">https://docs.velociraptor.app/docs/artifacts/security/#basic-artifacts
      </a>
      <br>
      <br>To detect unintended privilege escalations in custom artifacts, users should run the artifact verifier as described here&nbsp;
      <a target="_blank" rel="nofollow" href="https://docs.velociraptor.app/docs/artifacts/security/#restricting-dangerous-client-artifacts">https://docs.velociraptor.app/docs/artifacts/security/#restricting-dangerous-client-artifacts
      </a>
    </p>
  </div>
  <div class="rnd pad sec vgap" id="credits">
    <h2>Credits:
    </h2>
    <p>We thank Christian Fünfhaus  from Deutsche Bahn CSIRT for identifying and reporting this issue
    </p>
  </div>
  <div id="references">
    <h2>References
    </h2>
    <p>
    </p>
    <div>
      <a href="https://docs.velociraptor.app/announcements/advisories/cve-2025-6264/">docs.velociraptor.app/announcements/advisories/cve-2025-6264/
      </a>
    </div>
    <p>
    </p>
  </div>
</div>
