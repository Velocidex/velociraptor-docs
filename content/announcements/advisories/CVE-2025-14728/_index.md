---
menutitle: "CVE-2025-14728"
title: "CVE-2025-14728 Velociraptor directory traversal vulnerability"
description: |
    Velociraptor normally is only allowed to write in the datastore. However,
    under some situations it is possible for a rogue client to write files
    outside the datastore.

weight: 9
date: 2025-12-20T00:00:00Z
no_edit: true
noTitle: false
no_children: true
---

{{< include-html "CVE-2025-14728.html" >}}

## Further details

When Velociraptor receives an uploaded file from the client, the
server writes the file into the client's part of the datastore
directory. The path under which the file is written is made to
resemble the original path on the client as much as possible, except
that certain characters are escaped.

For example, if the path contains a ":" character (e.g. `C:\Windows`)
this is escaped since this character is not representable on a Windows
filesystem. Additionally, velociraptor escapes directory traversal
sequences like `..`.

On Windows, filenames that end with a "." are not representable, with
windows silently dropping the final "." from the filename. This causes
[corruption when the server runs on
Windows](https://github.com/Velocidex/velociraptor/pull/1348).

In the specific case of a path component that ends with a ".",
Velociraptor escapes the final "." to "%2E", but neglects to escape
other directory traversal characters in that path component. This
results in some directory traversal characters being propagated into
the path itself.

The vulnerability allows a rogue client to upload files to unintended
directories on the server, as long as the containing directory name
ends with a "%2E".

On Windows, Velociraptor uses raw device paths which do not support
directory traversal at all. Therefore, this vulnerability is not
exploitable on
Windows. (e.g. `\\?\C:\datastore\clients\C.1234\..\test.txt` is not a
valid path)

## Recommendation

This vulnerability requires upgrading the server as described in
[Server Upgrades]({{< ref "/docs/deployment/server/upgrades/" >}}).

* On Windows the vulnerability is not exploitable.
* If running the 0.75 release on a Linux server, please use the
  [velociraptor-v0.75.6-linux-amd64]({{< ref "/downloads/" >}})
  release.
* If running the 0.74 release on a Linux server, please use the
  [velociraptor-v0.74.6-linux-amd64]({{< ref "/downloads/previous_downloads/" >}})
  release.

Older versions are vulnerable and should be upgraded immediately.
