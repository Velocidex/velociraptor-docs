{
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "modules": [
                        "MSI Installer"
                    ],
                    "platforms": [
                        "Windows"
                    ],
                    "product": "Velociraptor",
                    "programFiles": [
                        "https://github.com/Velocidex/velociraptor/blob/master/docs/wix/velociraptor_amd64.xml"
                    ],
                    "repo": "https://github.com/Velocidex/velociraptor",
                    "vendor": "Rapid7",
                    "versions": [
                        {
                            "changes": [
                                {
                                    "at": "0.73.3",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "0.73.3",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "reporter",
                    "value": "We thank Jean-Baptiste Mesnard-Sense from SYNACKTIV for identifying and reporting this issue"
                }
            ],
            "datePublic": "2024-11-03T14:34:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "The Velociraptor Windows MSI installer creates the installation directory with WRITE_DACL permission to the BUILTIN\\Users group. This allows local users who are not administrators to grant themselves the Full Control permission on Velociraptor's files. By modifying Velociraptor's files, local users can subvert the binary and cause the Velociraptor service to execute arbitrary code as the SYSTEM user, or to replace the Velociraptor binary completely.<br>"
                        }
                    ],
                    "value": "The Velociraptor Windows MSI installer creates the installation directory with WRITE_DACL permission to the BUILTIN\\Users group. This allows local users who are not administrators to grant themselves the Full Control permission on Velociraptor's files. By modifying Velociraptor's files, local users can subvert the binary and cause the Velociraptor service to execute arbitrary code as the SYSTEM user, or to replace the Velociraptor binary completely."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-165",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-165 File Manipulation"
                        }
                    ]
                },
                {
                    "capecId": "CAPEC-233",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-233 Privilege Escalation"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "YES",
                        "Recovery": "USER",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "NONE",
                        "attackVector": "LOCAL",
                        "baseScore": 8.6,
                        "baseSeverity": "HIGH",
                        "privilegesRequired": "LOW",
                        "providerUrgency": "RED",
                        "subAvailabilityImpact": "HIGH",
                        "subConfidentialityImpact": "HIGH",
                        "subIntegrityImpact": "HIGH",
                        "userInteraction": "ACTIVE",
                        "valueDensity": "DIFFUSE",
                        "vectorString": "CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:A/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/AU:Y/R:U/V:D/RE:L/U:Red",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "HIGH",
                        "vulnConfidentialityImpact": "HIGH",
                        "vulnIntegrityImpact": "HIGH",
                        "vulnerabilityResponseEffort": "LOW"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-552",
                            "description": "CWE-552 Files or Directories Accessible to External Parties",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-732",
                            "description": "CWE-732 Incorrect Permission Assignment for Critical Resource",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "00000000-0000-4000-9000-000000000000"
            },
            "references": [
                {
                    "url": "https://docs.velociraptor.app/announcements/2024-cves/"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "For new installs use the updated MSI. If you do not wish to upgrade the endpoint client at this time, please arrange to run the icacls.exe command sequence above at the earliest time."
                        }
                    ],
                    "value": "For new installs use the updated MSI. If you do not wish to upgrade the endpoint client at this time, please arrange to run the icacls.exe command sequence above at the earliest time."
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "tags": [
                "x_open-source"
            ],
            "timeline": [
                {
                    "lang": "en",
                    "time": "2024-10-28T15:23:00.000Z",
                    "value": "Initial Notification by SYNACKTIV"
                },
                {
                    "lang": "en",
                    "time": "2024-11-03T15:24:00.000Z",
                    "value": "0.73.3 was released to address this issue and an advisory published on Velociraptor's website."
                }
            ],
            "title": "Local Privilege Escalation In Windows Velociraptor Service",
            "workarounds": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "In the Velociraptor start a hunt over all your Windows Assets, select the&nbsp;Windows.System.PowerShell artifact and paste the following in the&nbsp;Command parameter:<br><br><br>icacls.exe \"c:\\Program Files\\Velociraptor\" /inheritance:d /t /c ; icacls.exe \"c:\\Program Files\\Velociraptor\" /remove builtin\\users /t /c<br><br><br>This hunt will update the ACLs on the Velociraptor directory to remove all BUILTIN\\Users permissions."
                        }
                    ],
                    "value": "In the Velociraptor start a hunt over all your Windows Assets, select the Windows.System.PowerShell artifact and paste the following in the Command parameter:\n\n\nicacls.exe \"c:\\Program Files\\Velociraptor\" /inheritance:d /t /c ; icacls.exe \"c:\\Program Files\\Velociraptor\" /remove builtin\\users /t /c\n\n\nThis hunt will update the ACLs on the Velociraptor directory to remove all BUILTIN\\Users permissions."
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        }
    },
    "cveMetadata": {
        "assignerOrgId": "00000000-0000-4000-9000-000000000000",
        "cveId": "CVE-2024-10526",
        "requesterUserId": "00000000-0000-4000-9000-000000000000",
        "serial": 1,
        "state": "PUBLISHED"
    },
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1"
}