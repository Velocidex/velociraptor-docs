{
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://github.com/Velocidex/velociraptor/releases",
                    "defaultStatus": "unaffected",
                    "modules": [
                        "CreateCollection API"
                    ],
                    "packageName": "Velociraptor",
                    "platforms": [
                        "Windows",
                        "Linux",
                        "MacOS",
                        "64 bit",
                        "32 bit"
                    ],
                    "product": "Velociraptor",
                    "programFiles": [
                        "https://github.com/Velocidex/velociraptor/blob/master/services/launcher/launcher.go"
                    ],
                    "programRoutines": [
                        {
                            "name": "ScheduleArtifactCollection()"
                        }
                    ],
                    "repo": "https://github.com/Velocidex/velociraptor/",
                    "vendor": "Rapid7",
                    "versions": [
                        {
                            "changes": [
                                {
                                    "at": "5",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "0.6.7-5",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Velociraptor deployment with multiple users at lower roles than administrators (e.g. \"investigators\")<br>"
                        }
                    ],
                    "value": "Velociraptor deployment with multiple users at lower roles than administrators (e.g. \"investigators\")\n"
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "user": "00000000-0000-4000-9000-000000000000",
                    "value": "Paul Alkemade from Telstra"
                }
            ],
            "datePublic": "2023-01-17T14:00:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Velociraptor did not properly sanitize the client id parameter to the CreateCollection API allowing a directory traversal in where the collection task could be written. It was possible to provide a client id of \"../clients/server\" to schedule the collection for the server (as a server artifact), but only require privileges to schedule collections on the client.<br><br>Normally to schedule an artifact on the server requires the COLLECT_SERVER permissions (normally only granted to \"administrator\" role), but due to this issue it is sufficient to have the COLLECT_CLIENT privilege (normally granted to the \"investigator\" role)<br><p>To exploit this vulnerability, the attacker must already have a Velociraptor user account at a low privilege level (not administrator but at least \"investigator\").&nbsp;Be able to authenticate to the GUI (e.g. via OAuth2) and issue an API call to the backend. Typically most users deploy Velociraptor with limited access to a trusted group (most users will be administrators within the GUI).<br><br></p><p>This vulnerability is associated with program files <tt><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.Com/Velocidex/velociraptor/blob/master/services/launcher/launcher.go\">https://github.Com/Velocidex/velociraptor/blob/master/services/launcher/launcher.go</a></tt> and program routines <tt>ScheduleArtifactCollection()</tt>.</p><p>This issue affects Velociraptor: before 0.6.7-5.</p>"
                        }
                    ],
                    "value": "Velociraptor did not properly sanitize the client id parameter to the CreateCollection API allowing a directory traversal in where the collection task could be written. It was possible to provide a client id of \"../clients/server\" to schedule the collection for the server (as a server artifact), but only require privileges to schedule collections on the client.\n\nNormally to schedule an artifact on the server requires the COLLECT_SERVER permissions (normally only granted to \"administrator\" role), but due to this issue it is sufficient to have the COLLECT_CLIENT privilege (normally granted to the \"investigator\" role)\nTo exploit this vulnerability, the attacker must already have a Velociraptor user account at a low privilege level (not administrator but at least \"investigator\").Â Be able to authenticate to the GUI (e.g. via OAuth2) and issue an API call to the backend. Typically most users deploy Velociraptor with limited access to a trusted group (most users will be administrators within the GUI).\n\n\n\nThis vulnerability is associated with program files  https://github.Com/Velocidex/velociraptor/blob/master/services/launcher/launcher.go https://github.Com/Velocidex/velociraptor/blob/master/services/launcher/launcher.go  and program routines ScheduleArtifactCollection().\n\nThis issue affects Velociraptor: before 0.6.7-5.\n\n"
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-233",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-233 Privilege Escalation"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 8.1,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "HIGH",
                        "scope": "CHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-22",
                            "description": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "00000000-0000-4000-9000-000000000000"
            },
            "references": [
                {
                    "url": "https://github.com/Velocidex/velociraptor"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Upgrade to 0.6.7-5<br>"
                        }
                    ],
                    "value": "Upgrade to 0.6.7-5\n"
                }
            ],
            "source": {
                "discovery": "EXTERNAL"
            },
            "timeline": [
                {
                    "lang": "en",
                    "time": "2023-01-13T05:23:00.000Z",
                    "value": "Notification of the issue"
                },
                {
                    "lang": "en",
                    "time": "2023-01-17T02:00:00.000Z",
                    "value": "Release 0.6.7-5 made available on Github"
                }
            ],
            "title": "Directory traversal in Client Id parameter ",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    },
    "cveMetadata": {
        "assignerOrgId": "00000000-0000-4000-9000-000000000000",
        "cveId": "CVE-2023-0290",
        "requesterUserId": "00000000-0000-4000-9000-000000000000",
        "serial": 1,
        "state": "PUBLISHED"
    },
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0"
}